/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[8500],{79803:function(e,t,a){a.d(t,{Fh:function(){return i},ZC:function(){return l},cv:function(){return o},dW:function(){return u},i0:function(){return r},mY:function(){return s}});var n=a(52806);function o(e){return(0,n.Z)({params:{method:"problem.get",data:{selectAcknowledges:"extend",selectTags:"extend",selectSuppressionData:"extend",sortfield:"clock",sortorder:"DESC",...e}}})}function i(e){return(0,n.Z)({params:{method:"event.acknowledge",data:e}})}function r(e){return(0,n.Z)({params:{method:"action.create",data:e}})}function l(e){return(0,n.Z)({params:{method:"action.update",data:e}})}function s(e){return(0,n.Z)({params:{method:"action.get",data:e}})}function u(e){return(0,n.Z)({params:{method:"action.delete",data:e}})}},35068:function(e,t,a){a.d(t,{Z:function(){return u}});var n=a(74842),o=(a(24549),a(94851),a(66252));const i={class:"right-panel"};var r=(0,o.aZ)({__name:"VabQueryFormRightPanel",props:{span:{type:Number,default:10}},setup(e){return(t,a)=>{const r=n.Dv;return(0,o.wg)(),(0,o.j4)(r,{lg:e.span,md:24,sm:24,xl:e.span,xs:24},{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o.WI)(t.$slots,"default")])])),_:3},8,["lg","xl"])}}});function l(e){e.__source="library/components/VabQueryForm/components/VabQueryFormRightPanel.vue"}"function"===typeof l&&l(r);const s=r;var u=s},48499:function(e,t,a){a.d(t,{Z:function(){return p}});var n=a(74842),o=(a(24549),a(94851),a(66252));const i={class:"top-panel"};function r(e,t){const a=n.Dv;return(0,o.wg)(),(0,o.j4)(a,{span:24},{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o.WI)(e.$slots,"default")])])),_:3})}function l(e){e.__source="library/components/VabQueryForm/components/VabQueryFormTopPanel.vue"}var s=a(83744);const u={};"function"===typeof l&&l(u);const d=(0,s.Z)(u,[["render",r]]);var p=d},58818:function(e,t,a){a.d(t,{Z:function(){return d}});var n=a(28314),o=(a(24549),a(7436),a(66252));function i(e,t){const a=n.dq;return(0,o.wg)(),(0,o.j4)(a,{class:"vab-query-form",gutter:0},{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"default",{},void 0,!0)])),_:3})}function r(e){e.__source="library/components/VabQueryForm/index.vue"}var l=a(83744);const s={};"function"===typeof r&&r(s);const u=(0,l.Z)(s,[["render",i],["__scopeId","data-v-4d22213e"]]);var d=u},5743:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=a(64654),o=(a(24549),a(16135),a(91067)),i=(a(78526),a(47546)),r=(a(49653),a(37965)),l=(a(82880),a(60717),a(66252)),s=a(3577),u=a(2262),d={__name:"CustomTable",props:{columnList:{type:Array,default:()=>[]},listData:{type:Array,default:()=>[]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},total:{type:Number,default:0},pageNo:{type:Number,default:0},pageSize:{type:Number,default:20},maxHeight:{type:[String,Number],default:"auto"},className:{type:String,default:""},idkey:{type:String,default:""},listLoading:{type:Boolean,default:!0},isIndex:{type:Boolean,default:!1},isSelection:{type:Boolean,default:!0},isPagination:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},spanMethod:{type:Function,default:()=>{}}},emits:["sizeChange","currentChange","selectRows","sortChange","spanMethod"],setup(e,{expose:t,emit:a}){const d=(0,u.iH)(null),p=e=>{a("sizeChange",e)},c=e=>{a("currentChange",e)},f=e=>{a("selectRows",e)},m=e=>{a("sortChange",e)};function g(e){e&&(console.log("row :>> ",e),d.value.toggleRowSelection(e))}return(0,l.dl)((()=>{d?.value?.doLayout()})),(0,l.bv)((()=>{d.value.doLayout()})),t({tableRef:d,toggleRowSelection:g}),(t,a)=>{const u=i.$Y,g=r.GT,y=i.eI,h=o.R,w=n.t;return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.wy)(((0,l.wg)(),(0,l.j4)(y,{ref_key:"tableRef",ref:d,class:(0,s.C_)(["custom-table",e.className]),data:e.listData,border:!0,"row-key":e.idkey,"max-height":e.maxHeight,"span-method":e.spanMethod,stripe:e.stripe,onSelectionChange:f,onSortChange:m},{empty:(0,l.w5)((()=>[(0,l.Wm)(g,{description:"暂无数据"})])),default:(0,l.w5)((()=>[e.isSelection?((0,l.wg)(),(0,l.j4)(u,{key:0,fixed:"left",type:"selection",width:"55"})):(0,l.kq)("",!0),e.isIndex?((0,l.wg)(),(0,l.j4)(u,{key:1,fixed:"left",label:"序号",type:"index",width:"55"})):(0,l.kq)("",!0),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.columnList,(e=>((0,l.wg)(),(0,l.j4)(u,{key:e.prop,label:e.label,prop:e.prop,"show-overflow-tooltip":e.tooltip,"class-name":"operation"===e.prop?"operation-btns "+e.className:e.className,align:e.align?e.align:"left",sortable:e.sortable,width:e.width,"min-width":e.minWidth,fixed:"true"==e.fixed||"right"==e.fixed&&"right"},(0,l.Nv)({_:2},[e.isHeaderRender?{name:"header",fn:(0,l.w5)((()=>[(0,l.WI)(t.$slots,e.prop+"Header",{column:e})])),key:"0"}:void 0,e.isRender?{name:"default",fn:(0,l.w5)((({row:a,$index:n,column:o})=>[(0,l.WI)(t.$slots,e.prop,{row:a,index:n,column:o})])),key:"1"}:{name:"default",fn:(0,l.w5)((({row:t})=>[(0,l._)("span",{class:"name"},(0,s.zw)(t[e.prop]||"---"),1)])),key:"2"}]),1032,["label","prop","show-overflow-tooltip","class-name","align","sortable","width","min-width","fixed"])))),128))])),_:3},8,["class","data","row-key","max-height","span-method","stripe"])),[[w,e.listLoading]]),e.isPagination?((0,l.wg)(),(0,l.j4)(h,{key:0,"current-page":e.pageNo,layout:e.layout,"page-size":e.pageSize,total:e.total,onCurrentChange:c,onSizeChange:p},null,8,["current-page","layout","page-size","total"])):(0,l.kq)("",!0)],64)}}};function p(e){e.__source="src/components/CustomTable.vue"}var c=a(83744);"function"===typeof p&&p(d);const f=(0,c.Z)(d,[["__scopeId","data-v-bdd84b16"]]);var m=f},68500:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var n=a(58818),o=a(35068),i=a(49530),r=(a(24549),a(80773),a(48499)),l=a(21211),s=(a(12791),a(6715),a(57847)),u=(a(43872),a(57658),a(66252)),d=a(49963),p=a(2262),c=a(3577),f=a(79803),m=a(5743),g=a(22201),y={__name:"AlarmNotify",setup(e){const t=(0,u.RC)((()=>Promise.all([a.e(922),a.e(1108),a.e(6860),a.e(7020),a.e(9218)]).then(a.bind(a,37020)))),y={1001:"短信",1002:"邮件",1004:"企业微信",1003:"钉钉"},h=[{prop:"name",label:"通知组名称",tooltip:!0,minWidth:"130"},{prop:"update_operations",label:"已选用户数",tooltip:!0,isRender:!0},{prop:"filter",label:"已选设备数",tooltip:!0,isRender:!0},{prop:"mediatypeid",label:"通知方式",tooltip:!0,isRender:!0},{align:"right",fixed:"right",label:"操作",tooltip:!0,width:"100",prop:"operation",isRender:!0}],w=(0,g.tv)(),b=(0,u.f3)("$baseTableHeight"),v=(0,u.f3)("$baseMessage"),_=(0,u.f3)("$baseConfirm"),k=(0,p.iH)(null),S=(0,p.iH)({simpleMessage:!0,selectUpdateOperations:"extend",selectFilter:"extend",output:["name","choose_type","status","actionid"],current:1,limit:10,search:{name:""},filter:{eventsource:0}}),x=(0,p.qj)({height:b(3)-30,alarmHIstoryData:[],selectRows:[],alarmNotifyInfoData:{visible:!1,title:"新建告警通知组",type:"new",data:{name:"",dimensionality:"device",deviceid:[],userid:[],notification:[]}}}),C=e=>{let t=0,a=0;return e.map((e=>{"1001"===e.opmessage.mediatypeid||"1002"===e.opmessage.mediatypeid?t+=e.usercount:a++})),`用户数：${t}，群组数：${a}`},N=e=>{if(e.update_operations.length){let t=e?.update_operations.map((e=>e.opmessage.type?"1"===e.opmessage.type?"企业微信":"钉钉":y[e.opmessage.mediatypeid]));return t=[...new Set(t)],t.join("，")}return"---"},U=e=>{S.value.limit=e,Z()},D=e=>{S.value.current=e,Z()},I=()=>{S.value.current=1,Z()},R=e=>{x.selectRows=e},W=()=>{x.height=k.value.offsetHeight-32-48-48},Z=()=>{x.loading=!0,x.alarmHIstoryData=[],(0,f.mY)(S.value).then((e=>{if(!e.error)for(const t in e)if(Object.hasOwnProperty.call(e,t)){const a=e[t];x.total=Number(a.total),x.alarmHIstoryData.push(a)}x.loading=!1})).catch((e=>{console.log("err :>> ",e),x.loading=!1}))};function H(){w.push({name:"AlarmNotifyDetail",query:{}})}function z(){x.alarmNotifyInfoData.visible=!1}function j(e){w.push({name:"AlarmNotifyDetail",query:{actionid:e.actionid}})}function $(e){const t=[];if(e.actionid?t.push(e.actionid):x.selectRows.forEach((e=>{t.push(e.actionid)})),!t.length)return!1;_("你确定要删除吗",null,"delete",(async()=>{(0,f.dW)(t).then((e=>{e.error||(v("删除成功","success"),Z())})).catch((e=>{console.log("err :>> ",e)}))}))}return(0,u.bv)((()=>{W(),Z()})),(e,a)=>{const f=s.EZ,g=l.nH,y=l.ly,w=r.Z,b=i.ElButton,v=o.Z,_=n.Z;return(0,u.wg)(),(0,u.iD)("div",{ref_key:"alarmRef",ref:k,class:"alarm-container"},[(0,u.Wm)(_,null,{default:(0,u.w5)((()=>[(0,u.Wm)(w,{span:12},{default:(0,u.w5)((()=>[(0,u.Wm)(y,{class:"query-info-form",inline:"","label-width":"0px",onSubmit:a[1]||(a[1]=(0,d.iM)((()=>{}),["prevent"]))},{default:(0,u.w5)((()=>[(0,u.Wm)(g,{label:"",class:"form-name"},{default:(0,u.w5)((()=>[(0,u.Wm)(f,{modelValue:(0,p.SU)(S).search.name,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,p.SU)(S).search.name=e),placeholder:"请输入群组名称搜索",clearable:"",onChange:I},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,u.Wm)(v,{span:12},{default:(0,u.w5)((()=>[(0,u.Wm)(b,{onClick:$},{default:(0,u.w5)((()=>[(0,u.Uk)("删除")])),_:1}),(0,u.Wm)(b,{type:"primary",onClick:H},{default:(0,u.w5)((()=>[(0,u.Uk)(" 新建 ")])),_:1})])),_:1})])),_:1}),(0,u.Wm)(m["default"],{ref:"userTableRef","max-height":(0,p.SU)(x).height,"class-name":"alarm-table","list-loading":(0,p.SU)(x).loading,"list-data":(0,p.SU)(x).alarmHIstoryData,"column-list":h,total:(0,p.SU)(x).total,"page-no":(0,p.SU)(S).current,"page-size":(0,p.SU)(S).limit,onSizeChange:U,onCurrentChange:D,onSelectRows:R},{update_operations:(0,u.w5)((({row:e})=>[(0,u.Uk)((0,c.zw)(C(e.update_operations)),1)])),filter:(0,u.w5)((({row:e})=>[(0,u.Uk)(" 设备数： "+(0,c.zw)(e.filter?.conditions.length||"0"),1)])),mediatypeid:(0,u.w5)((({row:e})=>[(0,u.Uk)((0,c.zw)(N(e)),1)])),operation:(0,u.w5)((({row:e})=>[(0,u.Wm)(b,{text:"",type:"primary",onClick:t=>j(e)},{default:(0,u.w5)((()=>[(0,u.Uk)(" 编辑 ")])),_:2},1032,["onClick"]),(0,u.Wm)(b,{text:"",type:"primary",onClick:t=>$(e)},{default:(0,u.w5)((()=>[(0,u.Uk)(" 删除 ")])),_:2},1032,["onClick"])])),_:1},8,["max-height","list-loading","list-data","total","page-no","page-size"]),(0,p.SU)(x).alarmNotifyInfoData.visible?((0,u.wg)(),(0,u.j4)((0,p.SU)(t),{key:0,"alarm-notify-info-data":(0,p.SU)(x).alarmNotifyInfoData.data,title:(0,p.SU)(x).alarmNotifyInfoData.title,visible:(0,p.SU)(x).alarmNotifyInfoData.visible,type:(0,p.SU)(x).alarmNotifyInfoData.type,onCancel:z,onConfirm:Z},null,8,["alarm-notify-info-data","title","visible","type"])):(0,u.kq)("",!0)],512)}}};function h(e){e.__source="src/views/problem/alarm-setting/AlarmNotify.vue"}var w=a(83744);"function"===typeof h&&h(y);const b=(0,w.Z)(y,[["__scopeId","data-v-5e704e33"]]);var v=b}}]);