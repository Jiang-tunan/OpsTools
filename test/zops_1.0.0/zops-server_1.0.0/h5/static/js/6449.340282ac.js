/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[6449],{18907:function(e,t,n){n.d(t,{KW:function(){return i},Kj:function(){return p},Ld:function(){return l},Ob:function(){return m},Ox:function(){return u},Wh:function(){return c},XF:function(){return o},bm:function(){return s},uX:function(){return r},v0:function(){return d},y2:function(){return f}});var a=n(52806);function o(e){return(0,a.Z)({params:{method:"host.get",data:e}})}function r(e){return(0,a.Z)({params:{method:"host.exportinventory",data:e}})}function i(e){return(0,a.Z)({params:{method:"host.update",data:e}})}function l(e){return(0,a.Z)({params:{method:"host.create",data:e}})}function s(e){return(0,a.Z)({params:{method:"host.discoverupdate",data:e}})}function u(e){return(0,a.Z)({params:{method:"host.delete",data:e}})}function d(e){return(0,a.Z)({params:{method:"hostgroup.get",data:e}})}function c(e){return(0,a.Z)({params:{method:"modeltype.create",data:e}})}function m(e){return(0,a.Z)({params:{method:"modeltype.get",data:e}})}function f(e){return(0,a.Z)({params:{method:"modeltype.update",data:e}})}function p(e){return(0,a.Z)({params:{method:"modeltype.delete",data:e}})}},79803:function(e,t,n){n.d(t,{Fh:function(){return r},ZC:function(){return l},cv:function(){return o},dW:function(){return u},i0:function(){return i},mY:function(){return s}});var a=n(52806);function o(e){return(0,a.Z)({params:{method:"problem.get",data:{selectAcknowledges:"extend",selectTags:"extend",selectSuppressionData:"extend",sortfield:"clock",sortorder:"DESC",...e}}})}function r(e){return(0,a.Z)({params:{method:"event.acknowledge",data:e}})}function i(e){return(0,a.Z)({params:{method:"action.create",data:e}})}function l(e){return(0,a.Z)({params:{method:"action.update",data:e}})}function s(e){return(0,a.Z)({params:{method:"action.get",data:e}})}function u(e){return(0,a.Z)({params:{method:"action.delete",data:e}})}},30575:function(e,t,n){n.d(t,{h:function(){return a}});const a={"":{name:"全部告警",value:""},0:{name:"未分类",value:0},1:{name:"信息",value:1},2:{name:"警告",value:2},3:{name:"一般严重",value:3},4:{name:"严重",value:4},5:{name:"灾难",value:5}}},22076:function(e,t,n){function a(e){const t=document.documentElement.clientWidth;return t>=1440?16*e:e*Math.round(t/1440*16)}function o(e,t,n){let o=0;return o="remToPx"===n?a(t):t,e?.value?.offsetHeight?e.value.offsetHeight-o:e?.offsetHeight?e.offsetHeight-o:void 0}function r(e,t){const n=new Map;for(const a of e)n.has(a[t])||n.set(a[t],a);return[...n.values()]}function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))}function l(e){let t=parseInt(e),n=0,a=0;return t>60&&(n=parseInt(t/60),t=parseInt(t%60),n>60&&(a=parseInt(n/60),n=parseInt(n%60))),{second:t,minute:n,hour:a}}n.d(t,{BE:function(){return i},NC:function(){return o},Nb:function(){return r},ZC:function(){return l}})},66449:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var a=n(49530),o=(n(24549),n(80773),n(57658),n(66252)),r=n(2262),i=n(3577),l=n(79803),s=n(5743),u=n(30575),d=n(18907),c=n(22076),m=n(51640),f=n(22201);const p={class:"monitor-details-table"},h=["onClick"];var g={__name:"MonitorDetails",setup(e){const t=(0,o.RC)((()=>Promise.all([n.e(922),n.e(1108),n.e(6860),n.e(1463)]).then(n.bind(n,54009)))),g=(0,o.RC)((()=>n.e(6135).then(n.bind(n,96062)))),v=[{prop:"severity",label:"告警等级",sortable:"custom",isRender:!0,width:"110",fixed:"left"},{prop:"delay",label:"状态",isRender:!0,width:"90"},{prop:"host",className:"host-name",label:"设备名称",tooltip:!0},{prop:"ip",label:"IP地址",tooltip:!0,width:"130"},{prop:"name",label:"告警信息",tooltip:!0},{prop:"during_time_str",label:"持续时间",tooltip:!0,width:"110"},{prop:"acknowledged",width:"110",label:"是否确认",isRender:!0},{prop:"acknowledges",className:"operation-log",label:"操作日志",width:"110",isRender:!0},{align:"right",fixed:"right",label:"操作",tooltip:!0,width:"100",prop:"operation",isRender:!0}],w={time_str:"clock"},x={clock:"time_str"},k=(0,f.yj)(),y=(0,o.f3)("$baseTableHeight"),b=(0,r.iH)(null),C=(0,r.iH)({current:1,limit:10,filter:{severity:""},search:{name:""},hostids:[k.query.hostid]}),_=(0,r.qj)({height:y(3)-30,selectRows:[],alarmInfoData:{visible:!1,data:{}},sortfield:null,sortorder:null,equipmentData:{}}),S=e=>{const t=e?.acknowledges[e.acknowledges.length-1]?.message;_.alarmInfoData={visible:!0,data:{eventid:e.eventid,name:e.name,message:t,acknowledges:e.acknowledges,ack_str:e.ack_str,acknowledge:"Yes"===e.ack_str,ignoreAlarm:!!e.delay,alert_delay:e.alert_delay}}};function D(){_.alarmInfoData.visible=!1}const Z=e=>{C.value.limit=e,H()},I=e=>{C.value.current=e,H()},U=e=>{_.selectRows=e},R=({prop:e,order:t})=>{_.sortfield=w[e],_.sortorder="ascending"===t?"ASC":"descending"===t?"DESC":"",H()},q=()=>{_.height=(0,c.NC)(b,7.89,"remToPx")},H=()=>{_.loading=!0,_.sortorder?(C.value.sortfield=_.sortfield,C.value.sortorder=_.sortorder):(C.value.sortorder="DESC",C.value.sortfield="clock"),_.alarmData=[],(0,l.cv)(C.value).then((e=>{if(!e.error){for(const n in e)if(Object.hasOwnProperty.call(e,n)){const t=e[n];_.total=Number(t.total),_.alarmData.push(t),t.severity&&(t.severityName=u.h[t.severity].name)}const t=x[C.value.sortfield];"ASC"===C.value.sortorder?_.alarmData.sort((function(e,n){return e[t]>n[t]?1:-1})):"DESC"===C.value.sortorder&&_.alarmData.sort((function(e,n){return e[t]<n[t]?1:-1}))}_.loading=!1})).catch((e=>{console.log("err :>> ",e),_.loading=!1}))};function N(){(0,d.XF)({output:"extend",selectGroups:["groupid","name"],selectIDC:["idcid","name"],selectInterfaces:"extend",selectParentTemplates:"extend",selectHouse:["houseid","name"],getHistory:!0,hostids:[k.query.hostid]}).then((e=>{e.error||(_.equipmentData=e[0])})).catch((e=>{console.log(e)}))}return(0,o.bv)((()=>{q(),H(),N()})),(e,n)=>{const l=a.ElButton;return(0,o.wg)(),(0,o.iD)("div",{ref_key:"monitorRef",ref:b,class:"monitor-details-container"},[(0,o.Wm)(m["default"],{"equipment-data":(0,r.SU)(_).equipmentData},null,8,["equipment-data"]),(0,o._)("div",p,[(0,o.Wm)(s["default"],{"max-height":(0,r.SU)(_).height,"list-loading":(0,r.SU)(_).loading,"list-data":(0,r.SU)(_).alarmData,"column-list":v,total:(0,r.SU)(_).total,"page-no":(0,r.SU)(C).current,"page-size":(0,r.SU)(C).limit,onSizeChange:Z,onCurrentChange:I,onSelectRows:U,onSortChange:R},{severity:(0,o.w5)((({row:e})=>[(0,o._)("span",{class:(0,i.C_)(["monitor-details-level-"+e.severity,"monitor-details-level"]),effect:"plain"},(0,i.zw)(e.severityName),3)])),delay:(0,o.w5)((({row:e})=>[(0,o._)("span",{class:(0,i.C_)("monitor-details-status-"+(e.delay?"1":"2"))},(0,i.zw)(e.delay?"问题":"忽略"),3)])),house:(0,o.w5)((({row:e})=>[(0,o.Uk)((0,i.zw)(e?.house?.name||"---"),1)])),acknowledged:(0,o.w5)((({row:e})=>[(0,o._)("span",{class:(0,i.C_)(["ack-str","ack-str-"+(e.acknowledged?"1":"0")]),onClick:t=>S(e)},(0,i.zw)(e.acknowledged?"是":"否"),11,h)])),acknowledges:(0,o.w5)((({row:e})=>[(0,o.Wm)((0,r.SU)(g),{"cloumn-data":e},null,8,["cloumn-data"])])),operation:(0,o.w5)((({row:e})=>[(0,o.Wm)(l,{text:"",type:"primary",onClick:t=>S(e)},{default:(0,o.w5)((()=>[(0,o.Uk)(" 处理 ")])),_:2},1032,["onClick"])])),_:1},8,["max-height","list-loading","list-data","total","page-no","page-size"])]),(0,r.SU)(_).alarmInfoData.visible?((0,o.wg)(),(0,o.j4)((0,r.SU)(t),{key:0,"alarm-info-data":(0,r.SU)(_).alarmInfoData.data,visible:(0,r.SU)(_).alarmInfoData.visible,onCancel:D,onSubmit:H},null,8,["alarm-info-data","visible"])):(0,o.kq)("",!0)],512)}}};function v(e){e.__source="src/views/monitoring-center/equipment-monitoring/device-monitor-info/MonitorDetails.vue"}var w=n(83744);"function"===typeof v&&v(g);const x=(0,w.Z)(g,[["__scopeId","data-v-f453d10e"]]);var k=x}}]);