/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[6897],{18907:function(e,t,n){n.d(t,{KW:function(){return o},Kj:function(){return m},Ld:function(){return u},Ob:function(){return h},Ox:function(){return r},Wh:function(){return d},XF:function(){return c},bm:function(){return i},uX:function(){return s},v0:function(){return l},y2:function(){return f}});var a=n(52806);function c(e){return(0,a.Z)({params:{method:"host.get",data:e}})}function s(e){return(0,a.Z)({params:{method:"host.exportinventory",data:e}})}function o(e){return(0,a.Z)({params:{method:"host.update",data:e}})}function u(e){return(0,a.Z)({params:{method:"host.create",data:e}})}function i(e){return(0,a.Z)({params:{method:"host.discoverupdate",data:e}})}function r(e){return(0,a.Z)({params:{method:"host.delete",data:e}})}function l(e){return(0,a.Z)({params:{method:"hostgroup.get",data:e}})}function d(e){return(0,a.Z)({params:{method:"modeltype.create",data:e}})}function h(e){return(0,a.Z)({params:{method:"modeltype.get",data:e}})}function f(e){return(0,a.Z)({params:{method:"modeltype.update",data:e}})}function m(e){return(0,a.Z)({params:{method:"modeltype.delete",data:e}})}},32134:function(e,t,n){n.d(t,{IP:function(){return s},MB:function(){return c},PN:function(){return u},YZ:function(){return i},iv:function(){return l},qb:function(){return d},tS:function(){return o},vP:function(){return r}});var a=n(52806);function c(e){return(0,a.Z)({params:{method:"idc.get",data:e}})}function s(e){return(0,a.Z)({params:{method:"idc.create",data:e}})}function o(e){return(0,a.Z)({params:{method:"idc.update",data:e}})}function u(e){return(0,a.Z)({params:{method:"idc.delete",data:e}})}function i(e){return(0,a.Z)({params:{method:"house.get",data:e}})}function r(e){return(0,a.Z)({params:{method:"house.create",data:e}})}function l(e){return(0,a.Z)({params:{method:"house.update",data:e}})}function d(e){return(0,a.Z)({params:{method:"house.delete",data:e}})}},22076:function(e,t,n){function a(e){const t=document.documentElement.clientWidth;return t>=1440?16*e:e*Math.round(t/1440*16)}function c(e,t,n){let c=0;return c="remToPx"===n?a(t):t,e?.value?.offsetHeight?e.value.offsetHeight-c:e?.offsetHeight?e.offsetHeight-c:void 0}function s(e,t){const n=new Map;for(const a of e)n.has(a[t])||n.set(a[t],a);return[...n.values()]}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))}function u(e){let t=parseInt(e),n=0,a=0;return t>60&&(n=parseInt(t/60),t=parseInt(t%60),n>60&&(a=parseInt(n/60),n=parseInt(n%60))),{second:t,minute:n,hour:a}}n.d(t,{BE:function(){return o},NC:function(){return c},Nb:function(){return s},ZC:function(){return u}})},96897:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var a=n(49530),c=(n(24549),n(80773),n(59109)),s=(n(65195),n(46538)),o=(n(20822),n(24434)),u=(n(98476),n(25099),n(57847)),i=(n(43872),n(57658),n(66252)),r=n(2262),l=n(3577),d=n(18907),h=n(32134),f=n(39049),m=n(22076);const p={class:"device-container"},v={class:"device-left-content"},y={class:"device-tree"},k={class:"device-right-content"},x={class:"device-right-title"},g={class:"title"},w={class:"result-list"},_={class:"check-name"};var U={__name:"SelectDevice",props:{title:{type:String,default:"选择设备"},selectDeviceData:{type:Object,default:()=>({})},visible:{type:Boolean,default:!1}},emits:["cancel","confirm"],setup(e,{emit:t}){const n=e,U=(0,r.iH)(null),{title:Z,visible:b,selectDeviceData:L}=(0,r.BK)(n),C={label:"name",children:"hosts"},S=(0,r.qj)({resultList:[],totality:0,selectType:"device",keyword:"",checkAll:!1,isIndeterminate:!1,deviceData:[],checkedData:[],checkKeys:[],deviceNum:0});async function D(){let e=[];"device"===S.selectType?e=await(0,d.v0)({selectHosts:["name","hostid"],search:{name:S.keyword}}):"idc"===S.selectType?e=await(0,h.MB)({output:["hosts","name","key"],selectHosts:"extend",hashosts:!0,search:{name:S.keyword}}):"dataCenter"===S.selectType&&(e=await(0,h.YZ)({selectHosts:"extend",output:["hosts","name","key"],hashosts:!0,search:{name:S.keyword}})),e.error||(S.deviceData=e,S.deviceNum=0,S.checkKeys=[],K(e))}function K(e){e.map((e=>{if(e.hosts?.length){for(let t=0;t<e.hosts.length;t++){const n=e.hosts[t];if(n.type=S.selectType,n.hostid){const e=L.value.devicedata.find((e=>e===n.hostid)),t=S.resultList.find((e=>e.hostid===n.hostid));e&&U?.value&&(S.checkKeys.push(n.key),S.resultList.push(n)),t&&U?.value&&S.checkKeys.push(n.key)}}S.deviceNum+=e.hosts?.length||0}S.deviceNum++})),S.resultList=(0,m.Nb)(S.resultList,"hostid"),S.checkKeys=[...new Set(S.checkKeys)],(0,i.Y3)((()=>{N()}))}function N(){const e=U.value.getCheckedNodes(!1);S.checkAll=S.deviceNum<=e.length&&!!S.deviceData.length,S.isIndeterminate=e.length>0&&e.length<S.deviceNum}async function I(){await D()}function W(){S.resultList=[]}function V(e,t){U.value.setChecked(t.key,!1,!1),S.resultList.splice(e,1),N()}function T(e){for(let a=S.resultList.length-1;a>=0;a--){const e=S.resultList[a];e.type===S.selectType&&S.resultList.splice(a,1)}const t=[];e.forEach((e=>{t.push(e.key)})),U.value?.setCheckedKeys(t,!1);const n=U.value.getCheckedNodes(!1);for(let a=0;a<n.length;a++){const e=n[a];e.hostid&&S.resultList.push(e)}S.resultList=(0,m.Nb)(S.resultList,"hostid")}function H(){t("cancel")}function B(){t("cancel");const e=[];for(let t=0;t<S.resultList.length;t++){const n=S.resultList[t];e.push(n.hostid)}t("confirm",e)}function E(e){const t=e?S.deviceData:[];T(t)}function A(e,t){if(e.hostid)if(N(),t)S.resultList.push(e),S.resultList=(0,m.Nb)(S.resultList,"hostid");else{const t=S.resultList.findIndex((t=>t.hostid===e.hostid)),n=L.value.devicedata.findIndex((t=>t===e.hostid)),a=S.checkKeys.findIndex((t=>t===e.key));t>-1&&S.resultList.splice(t,1),n>-1&&L.value.devicedata.splice(n,1),a>-1&&S.checkKeys.splice(a,1)}}return(0,i.bv)((()=>{D()})),(e,t)=>{const n=u.EZ,d=o.dn,h=o.KD,m=s.ElCheckbox,L=c.y,K=a.ElButton,N=(0,i.up)("vab-icon");return(0,i.wg)(),(0,i.j4)((0,r.SU)(f["default"]),{modelValue:(0,r.SU)(b),"onUpdate:modelValue":[t[3]||(t[3]=e=>(0,r.dq)(b)?b.value=e:null),H],title:(0,r.SU)(Z),width:"44rem",class:"device-dialog"},{footer:(0,i.w5)((()=>[(0,i.Wm)(K,{onClick:H},{default:(0,i.w5)((()=>[(0,i.Uk)("取消")])),_:1}),(0,i.Wm)(K,{type:"primary",onClick:B},{default:(0,i.w5)((()=>[(0,i.Uk)("确定")])),_:1})])),default:(0,i.w5)((()=>[(0,i._)("div",p,[(0,i._)("div",v,[(0,i.Wm)(n,{modelValue:(0,r.SU)(S).keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,r.SU)(S).keyword=e),placeholder:"请输入关键字搜索",clearable:"",onChange:D},null,8,["modelValue"]),(0,i.Wm)(h,{modelValue:(0,r.SU)(S).selectType,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,r.SU)(S).selectType=e),class:"select-type-group",onChange:I},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{label:"device"},{default:(0,i.w5)((()=>[(0,i.Uk)("设备")])),_:1}),(0,i.Wm)(d,{label:"idc"},{default:(0,i.w5)((()=>[(0,i.Uk)("机房")])),_:1}),(0,i.Wm)(d,{label:"dataCenter"},{default:(0,i.w5)((()=>[(0,i.Uk)("数据中心")])),_:1})])),_:1},8,["modelValue"]),(0,i._)("div",y,[(0,i.Wm)(m,{modelValue:(0,r.SU)(S).checkAll,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,r.SU)(S).checkAll=e),indeterminate:(0,r.SU)(S).isIndeterminate,onChange:E},{default:(0,i.w5)((()=>[(0,i.Uk)(" 全选 ")])),_:1},8,["modelValue","indeterminate"]),(0,i.Wm)(L,{ref_key:"deviceTree",ref:U,props:C,"node-key":"key","default-checked-keys":(0,r.SU)(S).checkKeys,"default-expand-all":!0,data:(0,r.SU)(S).deviceData,"show-checkbox":"",onCheckChange:A},null,8,["default-checked-keys","data"])])]),(0,i._)("div",k,[(0,i._)("div",x,[(0,i._)("span",g,"已选择"+(0,l.zw)((0,r.SU)(S).totality)+"台设备",1),(0,i.Wm)(K,{class:"empty-btn",type:"primary",text:"",onClick:W},{default:(0,i.w5)((()=>[(0,i.Uk)(" 清空 ")])),_:1})]),(0,i._)("ul",w,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,r.SU)(S).resultList,((e,t)=>((0,i.wg)(),(0,i.iD)("li",{key:t,class:"check-item"},[(0,i._)("span",_,(0,l.zw)(e.name),1),(0,i.Wm)(N,{class:"close-icon",icon:"close-line",onClick:n=>V(t,e)},null,8,["onClick"])])))),128))])])])])),_:1},8,["modelValue","title"])}}};function Z(e){e.__source="src/views/problem/component/AlarmNotifyInfo/SelectDevice.vue"}var b=n(83744);"function"===typeof Z&&Z(U);const L=(0,b.Z)(U,[["__scopeId","data-v-a1c63dc0"]]);var C=L}}]);