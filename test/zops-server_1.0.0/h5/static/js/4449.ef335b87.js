/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[4449],{72657:function(e,a,n){n.r(a),n.d(a,{default:function(){return z}});var o=n(64654),i=(n(24549),n(16135),n(59109)),t=(n(65195),n(31574)),l=(n(72698),n(72673),n(56864),n(50952)),r=(n(83646),n(49530)),c=(n(80773),n(57847)),s=(n(43872),n(66252)),d=n(2262),u=n(49963),m=n(3577),g=n(65781),f=n(12688);const p={class:"organization-content"},k={class:"search-content"},b={class:"custom-tree-node"},h={key:1},C={class:"el-dropdown-link"};var _={__name:"Organization",emits:["organizationNodeClick"],setup(e,{emit:a}){const _=(0,s.RC)((()=>Promise.all([n.e(922),n.e(1110)]).then(n.bind(n,88939)))),v=(0,s.f3)("$baseConfirm"),w=(0,s.f3)("$baseMessage"),y=(0,d.iH)(null),z={children:"children",label:"name",id:"usrgrpid"},D=(0,d.qj)({loading:!0,organizationName:"",backupName:"",currentKey:"",organizationData:[],orgInfoData:{visible:!1}}),N=e=>{y.value.filter(e)},W=()=>{D.orgInfoData={visible:!0,title:"新建组织",type:"new",data:{name:"",manager_id:"",memo:""}}},I=(e,a)=>!e||a.name.includes(e),R=()=>{D.loading=!0;const e={exceptdisable:!0};""!=D.organizationName&&(e.search=D.organizationName),(0,f.XN)(e).then((e=>{D.loading=!1,D.organizationData=e,!e.error&&e.length&&(D.currentKey=e[0]?.usrgrpid,y.value.setCurrentKey(e[0]?.usrgrpid),a("organizationNodeClick",e[0]))})).catch((e=>{D.loading=!1,console.log("err :>> ",e)}))};function U(){D.orgInfoData.visible=!1}function V(e){const a={name:e.name,usrgrpid:e.usrgrpid};(0,f.A6)(a).then((e=>{e.error?(e.isRename=!1,e.name=D.backupName):e.isRename=!1})).catch((()=>{e.isRename=!1,e.name=D.backupName}))}function K(e){e.isRename=!1,e.name=D.backupName}function x(e){e.isRename=!0,D.backupName=e.name}function M(e){D.orgInfoData={visible:!0,title:"编辑组织",type:"edit",data:{name:e.name,usrgrpid:e.usrgrpid,manager_id:e.manager_id,memo:e.memo}}}function j(e){if(!e.usrgrpid)return!1;v("你确定要删除吗",null,"delete",(async()=>{(0,f.Y)([e.usrgrpid]).then((e=>{e.error||(w("删除成功","success"),R())})).catch((e=>{console.log("err :>> ",e)}))}))}function S(e){a("organizationNodeClick",e)}return(0,s.bv)((()=>{R()})),(e,a)=>{const n=c.EZ,f=(0,s.up)("vab-icon"),v=r.ElButton,w=l.Q0,q=t.Df,E=t.o2,O=t.YK,Y=i.y,Z=o.t;return(0,s.wg)(),(0,s.iD)("div",p,[(0,s._)("div",k,[(0,s.Wm)(n,{modelValue:D.organizationName,"onUpdate:modelValue":a[0]||(a[0]=e=>D.organizationName=e),placeholder:"请输入组织名搜索",clearable:"","prefix-icon":(0,d.SU)(g.Search),onChange:N},null,8,["modelValue","prefix-icon"]),(0,s.Wm)(w,{content:"新增组织",placement:"top",effect:"light"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{class:"add-btn",onClick:W},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{icon:"add-line"})])),_:1})])),_:1})]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(Y,{ref_key:"organizationRef",ref:y,class:"organization-tree",data:D.organizationData,"default-expanded-keys":[1],props:z,"highlight-current":"","current-node-key":D.currentKey,"node-key":"usrgrpid","filter-node-method":I,onNodeClick:S},{default:(0,s.w5)((({node:e,data:o})=>[(0,s._)("span",b,[o.isRename?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"rename-label",onClick:a[1]||(a[1]=(0,u.iM)((()=>{}),["stop"]))},[(0,s.Wm)(n,{modelValue:o.name,"onUpdate:modelValue":e=>o.name=e,placeholder:"请输入数据中心名称",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),(0,s.Wm)(f,{class:"rename-icon icon-check",icon:"check-fill",onClick:(0,u.iM)((e=>V(o)),["stop"])},null,8,["onClick"]),(0,s.Wm)(f,{class:"rename-icon icon-close",icon:"close-fill",onClick:(0,u.iM)((e=>K(o)),["stop"])},null,8,["onClick"])])):((0,s.wg)(),(0,s.iD)("span",h,(0,m.zw)(e.label),1)),(0,s.Wm)(O,null,{dropdown:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s.Wm)(q,{onClick:e=>x(o)},{default:(0,s.w5)((()=>[(0,s.Uk)(" 重命名 ")])),_:2},1032,["onClick"]),(0,s.Wm)(q,{onClick:e=>M(o)},{default:(0,s.w5)((()=>[(0,s.Uk)(" 编辑 ")])),_:2},1032,["onClick"]),(0,s.Wm)(q,{onClick:e=>j(o)},{default:(0,s.w5)((()=>[(0,s.Uk)(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,s.w5)((()=>[(0,s._)("span",C,[(0,s.Wm)(f,{icon:"more-2-fill"})])])),_:2},1024)])])),_:1},8,["data","current-node-key"])),[[Z,D.loading]]),D.orgInfoData.visible?((0,s.wg)(),(0,s.j4)((0,d.SU)(_),{key:0,"organization-data":D.orgInfoData.data,title:D.orgInfoData.title,type:D.orgInfoData.type,visible:D.orgInfoData.visible,onCancel:U,onConfirm:R},null,8,["organization-data","title","type","visible"])):(0,s.kq)("",!0)])}}};function v(e){e.__source="src/views/system/user/Organization.vue"}var w=n(83744);"function"===typeof v&&v(_);const y=(0,w.Z)(_,[["__scopeId","data-v-8036340a"]]);var z=y}}]);