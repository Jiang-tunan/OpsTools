/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[8796,4747],{16992:function(e,a,n){n.r(a),n.d(a,{default:function(){return g}});var i=n(64654),c=(n(24549),n(16135),n(59109)),t=(n(65195),n(31574)),l=(n(72698),n(72673),n(56864),n(50952)),d=(n(83646),n(49530)),o=(n(80773),n(57847)),s=(n(43872),n(66252)),u=n(2262),r=n(49963),m=n(3577),f=n(65781),p=n(32134);const k={class:"idc-content"},h={class:"search-content"},v={class:"custom-tree-node"},b={key:1},D={class:"el-dropdown-link"};var w={__name:"DataCenter",emits:["idcNodeClick"],setup(e,{emit:a}){const w=(0,s.f3)("$baseConfirm"),C=(0,s.f3)("$baseMessage"),_=(0,s.RC)((()=>Promise.all([n.e(922),n.e(4289)]).then(n.bind(n,85752)))),y=(0,u.iH)(null),g={children:"children",label:"name",id:"idcid"},W=(0,u.iH)({hashosts:!1,search:{name:""}}),I=(0,u.qj)({loading:!0,idcName:"",backupData:{},backupName:{},currentKey:"",idcData:[],idcInfoData:{visible:!1,title:"新建数据中心（IDC）",type:"new",data:{name:"",userid:"",address:"",usrgrpid:""}}}),N=e=>{y.value.filter(e)},M=()=>{I.idcInfoData={visible:!0,title:"新建数据中心（IDC）",type:"new",data:{name:"",userid:"",address:"",usrgrpid:""}}},R=(e,a)=>!e||a.name.includes(e),U=()=>{I.loading=!0,(0,p.MB)(W.value).then((e=>{I.loading=!1,I.idcData=e,!e.error&&e.length&&(I.currentKey=e[0]?.idcid,y.value.setCurrentKey(e[0]?.idcid),a("idcNodeClick",e[0]))})).catch((e=>{I.loading=!1,console.log("err :>> ",e)}))};function x(){I.idcInfoData.visible=!1}function V(e){a("idcNodeClick",e)}function j(e){e.isRename=!0,I.backupName=e.name,I.backupData=e}function S(e){(0,p.tS)({name:e.name,idcid:e.idcid}).then((e=>{e.error?(I.backupData.isRename=!1,e.name=I.backupName):I.backupData.isRename=!1})).catch((()=>{e.isRename=!1,e.name=I.backupName}))}function q(e){I.backupData.isRename=!1,e.name=I.backupName}function H(e){I.idcInfoData={visible:!0,title:"编辑数据中心（IDC）",type:"edit",data:{name:e.name,userid:e.userid,address:e.address,idcid:e.idcid,usrgrpid:e.usrgrpid}}}function K(e){if(!e.idcid)return!1;w(`删除数据中心后不可恢复，确定要删除“${e.name}”吗？`,"删除数据中心","delete",(async()=>{(0,p.PN)([e.idcid]).then((e=>{e.error||(C("删除成功","success"),U())})).catch((e=>{console.log("err :>> ",e)}))}))}return(0,s.bv)((()=>{U()})),(e,a)=>{const n=o.EZ,p=(0,s.up)("vab-icon"),w=d.ElButton,C=l.Q0,B=t.Df,E=t.o2,Y=t.YK,Z=c.y,$=i.t;return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("div",h,[(0,s.Wm)(n,{modelValue:W.value.search.name,"onUpdate:modelValue":a[0]||(a[0]=e=>W.value.search.name=e),placeholder:"请输入关键字搜索",clearable:"","prefix-icon":(0,u.SU)(f.Search),onChange:N},null,8,["modelValue","prefix-icon"]),(0,s.Wm)(C,{content:"新增数据中心",placement:"top",effect:"light"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{class:"add-btn",onClick:M},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{icon:"add-line"})])),_:1})])),_:1})]),(0,s.wy)(((0,s.wg)(),(0,s.j4)(Z,{ref_key:"idcRef",ref:y,class:"idc-tree",data:I.idcData,"current-node-key":I.currentKey,"node-key":"idcid","highlight-current":"",props:g,"filter-node-method":R,onNodeClick:V},{default:(0,s.w5)((({node:e,data:i})=>[(0,s._)("span",v,[i.isRename?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"rename-label",onClick:a[1]||(a[1]=(0,r.iM)((()=>{}),["stop"]))},[(0,s.Wm)(n,{modelValue:i.name,"onUpdate:modelValue":e=>i.name=e,placeholder:"请输入数据中心名称",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),(0,s.Wm)(p,{class:"rename-icon icon-check",icon:"check-fill",onClick:(0,r.iM)((e=>S(i)),["stop"])},null,8,["onClick"]),(0,s.Wm)(p,{class:"rename-icon icon-close",icon:"close-fill",onClick:(0,r.iM)((e=>q(i)),["stop"])},null,8,["onClick"])])):((0,s.wg)(),(0,s.iD)("span",b,(0,m.zw)(e.label),1)),(0,s.Wm)(Y,null,{dropdown:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s.Wm)(B,{onClick:e=>j(i)},{default:(0,s.w5)((()=>[(0,s.Uk)(" 重命名 ")])),_:2},1032,["onClick"]),(0,s.Wm)(B,{onClick:e=>H(i)},{default:(0,s.w5)((()=>[(0,s.Uk)(" 编辑 ")])),_:2},1032,["onClick"]),(0,s.Wm)(B,{onClick:e=>K(i)},{default:(0,s.w5)((()=>[(0,s.Uk)(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,s.w5)((()=>[(0,s._)("span",D,[(0,s.Wm)(p,{icon:"more-2-fill"})])])),_:2},1024)])])),_:1},8,["data","current-node-key"])),[[$,I.loading]]),I.idcInfoData.visible?((0,s.wg)(),(0,s.j4)((0,u.SU)(_),{key:0,"idc-info-data":I.idcInfoData.data,title:I.idcInfoData.title,type:I.idcInfoData.type,visible:I.idcInfoData.visible,onCancel:x,onConfirm:U},null,8,["idc-info-data","title","type","visible"])):(0,s.kq)("",!0)])}}};function C(e){e.__source="src/views/system/idc/DataCenter.vue"}var _=n(83744);"function"===typeof C&&C(w);const y=(0,_.Z)(w,[["__scopeId","data-v-14b8a82b"]]);var g=y},90045:function(e,a,n){n.r(a),n.d(a,{default:function(){return k}});var i=n(28314),c=(n(24549),n(7436),n(74842)),t=(n(94851),n(66252)),l=n(2262),d=n(16992),o=n(26195),s=n(64067);const u={class:"idc-container"};var r={__name:"index",setup(e){const a=(0,l.iH)(null),n=(0,l.qj)({isMachina:!0,hostsData:{},idcData:{}});function r(e){n.isMachina=!0,(0,t.Y3)((()=>{a.value&&(n.idcData=e,a.value.queryByMachineRoom(e))}))}function m(e){n.hostsData={name:e.name,houseid:e.houseid,idcName:n.idcData.name},n.isMachina=!1}function f(){n.isMachina=!0,(0,t.Y3)((()=>{r(n.idcData)}))}return(e,p)=>{const k=c.Dv,h=i.dq;return(0,t.wg)(),(0,t.iD)("div",u,[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,{xs:8,sm:6,md:5,lg:4,xl:3,class:"idc-data-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(d["default"],{onIdcNodeClick:r})])),_:1}),(0,t.Wm)(k,{xs:14,sm:18,md:19,lg:20,xl:21},{default:(0,t.w5)((()=>[(0,l.SU)(n).isMachina?((0,t.wg)(),(0,t.j4)(o["default"],{key:0,ref_key:"machineRoomRef",ref:a,onHostsEvent:m},null,512)):((0,t.wg)(),(0,t.j4)(s["default"],{key:1,"hosts-data":(0,l.SU)(n).hostsData,onHostsBack:f},null,8,["hosts-data"]))])),_:1})])),_:1})])}}};function m(e){e.__source="src/views/system/idc/index.vue"}var f=n(83744);"function"===typeof m&&m(r);const p=(0,f.Z)(r,[["__scopeId","data-v-bc3b14e6"]]);var k=p}}]);