/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[5513],{18907:function(e,t,a){a.d(t,{KW:function(){return u},Kj:function(){return f},Ld:function(){return r},Ob:function(){return c},Ox:function(){return i},Wh:function(){return p},XF:function(){return l},bm:function(){return s},uX:function(){return o},v0:function(){return d},y2:function(){return m}});var n=a(52806);function l(e){return(0,n.Z)({params:{method:"host.get",data:e}})}function o(e){return(0,n.Z)({params:{method:"host.exportinventory",data:e}})}function u(e){return(0,n.Z)({params:{method:"host.update",data:e}})}function r(e){return(0,n.Z)({params:{method:"host.create",data:e}})}function s(e){return(0,n.Z)({params:{method:"host.discoverupdate",data:e}})}function i(e){return(0,n.Z)({params:{method:"host.delete",data:e}})}function d(e){return(0,n.Z)({params:{method:"hostgroup.get",data:e}})}function p(e){return(0,n.Z)({params:{method:"modeltype.create",data:e}})}function c(e){return(0,n.Z)({params:{method:"modeltype.get",data:e}})}function m(e){return(0,n.Z)({params:{method:"modeltype.update",data:e}})}function f(e){return(0,n.Z)({params:{method:"modeltype.delete",data:e}})}},32134:function(e,t,a){a.d(t,{IP:function(){return o},MB:function(){return l},PN:function(){return r},YZ:function(){return s},iv:function(){return d},qb:function(){return p},tS:function(){return u},vP:function(){return i}});var n=a(52806);function l(e){return(0,n.Z)({params:{method:"idc.get",data:e}})}function o(e){return(0,n.Z)({params:{method:"idc.create",data:e}})}function u(e){return(0,n.Z)({params:{method:"idc.update",data:e}})}function r(e){return(0,n.Z)({params:{method:"idc.delete",data:e}})}function s(e){return(0,n.Z)({params:{method:"house.get",data:e}})}function i(e){return(0,n.Z)({params:{method:"house.create",data:e}})}function d(e){return(0,n.Z)({params:{method:"house.update",data:e}})}function p(e){return(0,n.Z)({params:{method:"house.delete",data:e}})}},25488:function(e,t,a){a.d(t,{AA:function(){return l},Ic:function(){return i},es:function(){return o},ph:function(){return d},qE:function(){return r},tr:function(){return u},yp:function(){return s}});var n=a(52806);function l(e){return(0,n.Z)({params:{method:"drule.create",data:e}})}function o(e){return(0,n.Z)({params:{method:"drule.update",data:e}})}function u(e){return(0,n.Z)({params:{method:"drule.get",data:e}})}function r(e){return(0,n.Z)({params:{method:"drule.delete",data:e}})}function s(e){return(0,n.Z)({params:{method:"drule.activate",data:e}})}function i(e){return(0,n.Z)({params:{method:"drule.progress",data:e}})}function d(e){return(0,n.Z)({params:{method:"drule.stop",data:e}})}},22076:function(e,t,a){function n(e){const t=document.documentElement.clientWidth;return t>=1440?16*e:e*Math.round(t/1440*16)}function l(e,t,a){let l=0;return l="remToPx"===a?n(t):t,e?.value?.offsetHeight?e.value.offsetHeight-l:e?.offsetHeight?e.offsetHeight-l:void 0}function o(e,t){const a=new Map;for(const n of e)a.has(n[t])||a.set(n[t],n);return[...a.values()]}function u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0,a="x"==e?t:3&t|8;return a.toString(16)}))}function r(e){let t=parseInt(e),a=0,n=0;return t>60&&(a=parseInt(t/60),t=parseInt(t%60),a>60&&(n=parseInt(a/60),a=parseInt(a%60))),{second:t,minute:a,hour:n}}a.d(t,{BE:function(){return u},NC:function(){return l},Nb:function(){return o},ZC:function(){return r}})},5743:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var n=a(64654),l=(a(24549),a(16135),a(91067)),o=(a(78526),a(47546)),u=(a(49653),a(37965)),r=(a(82880),a(60717),a(66252)),s=a(3577),i=a(2262),d={__name:"CustomTable",props:{columnList:{type:Array,default:()=>[]},listData:{type:Array,default:()=>[]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},total:{type:Number,default:0},pageNo:{type:Number,default:0},pageSize:{type:Number,default:20},maxHeight:{type:[String,Number],default:"auto"},className:{type:String,default:""},idkey:{type:String,default:""},listLoading:{type:Boolean,default:!0},isIndex:{type:Boolean,default:!1},isSelection:{type:Boolean,default:!0},isPagination:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},spanMethod:{type:Function,default:()=>{}}},emits:["sizeChange","currentChange","selectRows","sortChange","spanMethod"],setup(e,{expose:t,emit:a}){const d=(0,i.iH)(null),p=e=>{a("sizeChange",e)},c=e=>{a("currentChange",e)},m=e=>{a("selectRows",e)},f=e=>{a("sortChange",e)};function h(e){e&&(console.log("row :>> ",e),d.value.toggleRowSelection(e))}return(0,r.dl)((()=>{d?.value?.doLayout()})),(0,r.bv)((()=>{d.value.doLayout()})),t({tableRef:d,toggleRowSelection:h}),(t,a)=>{const i=o.$Y,h=u.GT,v=o.eI,g=l.R,y=n.t;return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.wy)(((0,r.wg)(),(0,r.j4)(v,{ref_key:"tableRef",ref:d,class:(0,s.C_)(["custom-table",e.className]),data:e.listData,border:!0,"row-key":e.idkey,"max-height":e.maxHeight,"span-method":e.spanMethod,stripe:e.stripe,onSelectionChange:m,onSortChange:f},{empty:(0,r.w5)((()=>[(0,r.Wm)(h,{description:"暂无数据"})])),default:(0,r.w5)((()=>[e.isSelection?((0,r.wg)(),(0,r.j4)(i,{key:0,fixed:"left",type:"selection",width:"55"})):(0,r.kq)("",!0),e.isIndex?((0,r.wg)(),(0,r.j4)(i,{key:1,fixed:"left",label:"序号",type:"index",width:"55"})):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.columnList,(e=>((0,r.wg)(),(0,r.j4)(i,{key:e.prop,label:e.label,prop:e.prop,"show-overflow-tooltip":e.tooltip,"class-name":"operation"===e.prop?"operation-btns "+e.className:e.className,align:e.align?e.align:"left",sortable:e.sortable,width:e.width,"min-width":e.minWidth,fixed:"true"==e.fixed||"right"==e.fixed&&"right"},(0,r.Nv)({_:2},[e.isHeaderRender?{name:"header",fn:(0,r.w5)((()=>[(0,r.WI)(t.$slots,e.prop+"Header",{column:e})])),key:"0"}:void 0,e.isRender?{name:"default",fn:(0,r.w5)((({row:a,$index:n,column:l})=>[(0,r.WI)(t.$slots,e.prop,{row:a,index:n,column:l})])),key:"1"}:{name:"default",fn:(0,r.w5)((({row:t})=>[(0,r._)("span",{class:"name"},(0,s.zw)(t[e.prop]||"---"),1)])),key:"2"}]),1032,["label","prop","show-overflow-tooltip","class-name","align","sortable","width","min-width","fixed"])))),128))])),_:3},8,["class","data","row-key","max-height","span-method","stripe"])),[[y,e.listLoading]]),e.isPagination?((0,r.wg)(),(0,r.j4)(g,{key:0,"current-page":e.pageNo,layout:e.layout,"page-size":e.pageSize,total:e.total,onCurrentChange:c,onSizeChange:p},null,8,["current-page","layout","page-size","total"])):(0,r.kq)("",!0)],64)}}};function p(e){e.__source="src/components/CustomTable.vue"}var c=a(83744);"function"===typeof p&&p(d);const m=(0,c.Z)(d,[["__scopeId","data-v-bdd84b16"]]);var f=m},35513:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var n=a(21211),l=(a(24549),a(12791),a(47301)),o=(a(52783),a(49530)),u=(a(80773),a(1425)),r=(a(57469),a(38492)),s=(a(94687),a(79303),a(6715),a(57847)),i=(a(43872),a(57658),a(66252)),d=a(2262),p=a(3577),c=a(32134),m=a(5743),f=a(25498),h=a(7605),v=a(22076),g=a(18907),y=a(12688),b=a(25488),w=a(22201);const k=e=>((0,i.dD)("data-v-12a9a229"),e=e(),(0,i.Cn)(),e),_={class:"rules-info-container"},x=k((()=>(0,i._)("span",{class:"hyphen"},"-",-1)));var S={__name:"DiscoverInfo",props:{rulesInfoData:{type:Object,default:()=>({})},btnOperation:{type:Array,default:()=>[]},isDelay:{type:Boolean,default:!0},isIps:{type:Boolean,default:!1},isIpRange:{type:Boolean,default:!0},isGroup:{type:Boolean,default:!1},isCustomSubmitCompletion:{type:Boolean,default:!1},isUser:{type:Boolean,default:!1}},emits:["customSubmitCompletion"],setup(e,{expose:t,emit:k}){const S=e,U=(0,i.RC)((()=>Promise.all([a.e(922),a.e(8111)]).then(a.bind(a,35282)))),{rulesInfoData:I,btnOperation:C,isDelay:Z,isIpRange:V,isIps:W,isGroup:D,isUser:q,isCustomSubmitCompletion:H}=(0,d.BK)(S),j=(e,t,a)=>{if(I.value.ipbegin&&I.value.ipend){if(W.value)(0,f.h6)(I.value.ipend)?a():a(new Error((0,h.Iu)("请输入正确的IP范围")));else if(V.value)if((0,f.h6)(I.value.ipend)&&(0,f.h6)(I.value.ipbegin)){const e=I.value.ipbegin.lastIndexOf("."),t=I.value.ipend.lastIndexOf("."),n=I.value.ipbegin.substring(0,e),l=I.value.ipend.substring(0,t);n===l?a():a(new Error((0,h.Iu)("请输入同一地址段的IP")))}else a(new Error((0,h.Iu)("请输入正确的IP范围")))}else a(new Error((0,h.Iu)("请输入IP范围")))},N={ipbegin:[{required:!0,message:"请输入IP范围",trigger:"blur"},{validator:j,trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],dchecks:[{required:!0,message:"请选择发现方式",trigger:"change"}],groupid:[{required:!0,message:"请选择设备类型",trigger:"change"}],delay:[{required:!0,message:"请输入间隔",trigger:"blur"}]},P=[{key:"m",name:"分"},{key:"h",name:"时"},{key:"s",name:"秒"}],B=[{prop:"name",label:"检查类型",minWidth:"110"},{align:"right",fixed:"right",label:"操作",width:"150",prop:"operation",isRender:!0}],R=(0,d.iH)([]),E=(0,i.f3)("$baseMessage"),M=(0,d.iH)(null),O=(0,d.iH)([]),Y=(0,d.iH)([]),z=(0,w.tv)(),K=(0,w.yj)(),L=(0,d.iH)({title:"发现方式",type:"new",visible:!1,data:{}}),A=()=>{W.value&&(I.value.ipend=I.value.ipbegin)};function T(){O.value=[],(0,c.YZ)({}).then((e=>{!e.error&&e.length&&(O.value=e)})).catch((e=>{console.log(e)}))}function $(e){const t=I.value.dchecks.findIndex((t=>t.type===e.type));t>=0&&I.value.dchecks.splice(t,1)}function F(){I.value.dchecks||(I.value.dchecks=[]);const e=I.value.dchecks.map((e=>e.type));L.value={title:"发现方式",type:"new",visible:!0,data:{selectList:e,ports:"161",snmp_community:"{$SNMP_COMMUNITY}"}}}function G(e){I.value.dchecks||(I.value.dchecks=[]);const t=I.value.dchecks.map((e=>e.type));L.value={title:"发现方式",type:"edit",visible:!0,data:{selectList:t,id:e.id,name:e.name,type:e.type,ports:e.ports,snmp_community:e.snmp_community,snmpv3_securityname:e.snmpv3_securityname,snmpv3_authpassphrase:e.snmpv3_authpassphrase,snmpv3_privpassphrase:e.snmpv3_privpassphrase,snmpv3_contextname:e.snmpv3_contextname}}}function X(){L.value.visible=!1}function J(){const e={name:L.value.data.name,type:L.value.data.type,ports:L.value.data.ports,snmp_community:L.value.data.snmp_community,snmpv3_securityname:L.value.data.snmpv3_securityname,snmpv3_authpassphrase:L.value.data.snmpv3_authpassphrase,snmpv3_privpassphrase:L.value.data.snmpv3_privpassphrase,snmpv3_contextname:L.value.data.snmpv3_contextname};if(I.value.dchecks||(I.value.dchecks=[]),"new"===L.value.type)e.id=(0,v.BE)(),I.value.dchecks.push(e);else{const t=I.value.dchecks.findIndex((e=>e.id===L.value.data.id));t>-1&&(I.value.dchecks[t]={id:L.value.data.id,...e})}M.value.validateField("dchecks")}function Q(e){"scan"===e.key||"submit"===e.key?te(e.key):e.fun()}function ee(e){(0,b.yp)(e.druleids).then((e=>{if(!e.error){E("扫描自动发现规则触发成功","success");let t=sessionStorage.getItem("druleData")||"{}";t=JSON.parse(t),console.log("res :>> ",e),console.log("res :>> ",e.data[0].druleid),t={session:e.session,druleids:e.data[0].druleid},sessionStorage.setItem("druleData",JSON.stringify(t)),console.log("sessionStorage.getItem(druleData) :>> ",sessionStorage.getItem("druleData")),z.push({name:"GeneralDiscovery",query:{step:2,session:e.session,druleids:e.druleids}})}})).catch((e=>{console.log("error :>> ",e)}))}function te(e){M.value.validate((async t=>{if(t){const t={name:I.value.name,ipbegin:I.value.ipbegin,ipend:I.value.ipend,delay:I.value.delay+I.value.delayUnit,houseid:I.value.houseid,status:I.value.status,dchecks:[]};I.value.dchecks.map((e=>{const a={type:e.type};"9"!==e.type&&(e.ports&&(a.ports=e.ports),"13"!==e.type?e.snmp_community&&(a.snmp_community=e.snmp_community):(e.snmpv3_securityname&&(a.snmpv3_securityname=e.snmpv3_securityname),e.snmpv3_authpassphrase&&(a.snmpv3_authpassphrase=e.snmpv3_authpassphrase),e.snmpv3_privpassphrase&&(a.snmpv3_privpassphrase=e.snmpv3_privpassphrase),e.snmpv3_contextname&&(a.snmpv3_contextname=e.snmpv3_contextname))),t.dchecks.push(a)}));let a=null;K?.query.druleid?(t.druleid=K?.query.druleid,a=await(0,b.es)(t)):a=await(0,b.AA)(t),a.error||("scan"===e?ee(a):H.value?k("customSubmitCompletion"):(E((K?.query.druleid?"编辑":"创建")+"自动发现规则成功","success"),z.push({name:"DeviceDiscovery"})))}}))}function ae(){(0,g.v0)({}).then((e=>{R.value.push(...e)})).catch((e=>{console.log("error :>> ",e)}))}function ne(){(0,y.lE)({}).then((e=>{!e.error&&e.length&&(Y.value=e)})).catch((e=>{console.log(e)}))}return(0,i.bv)((()=>{T(),D.value&&ae(),q.value&&ne()})),t({ruleFormRef:M}),(e,t)=>{const a=s.EZ,c=n.nH,f=r.BT,h=r.ElSelect,v=u.d6,g=o.ElButton,y=(0,i.up)("vab-icon"),b=l.OX,w=n.ly;return(0,i.wg)(),(0,i.iD)("div",_,[(0,i.Wm)(w,{ref_key:"ruleFormRef",ref:M,model:(0,d.SU)(I),rules:N,"label-width":"5.4rem"},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{label:"设备名称",prop:"name"},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{modelValue:(0,d.SU)(I).name,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,d.SU)(I).name=e),placeholder:"请输入设备名称"},null,8,["modelValue"])])),_:1}),(0,d.SU)(W)?((0,i.wg)(),(0,i.j4)(c,{key:0,class:"ip-form",label:"IP范围",prop:"ipbegin"},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{modelValue:(0,d.SU)(I).ipbegin,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,d.SU)(I).ipbegin=e),placeholder:"请输入IP范围",onChange:A},null,8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,d.SU)(V)?((0,i.wg)(),(0,i.j4)(c,{key:1,class:"ip-form",label:"IP范围",prop:"ipbegin"},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{modelValue:(0,d.SU)(I).ipbegin,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,d.SU)(I).ipbegin=e),placeholder:"请输入IP范围"},null,8,["modelValue"]),x,(0,i.Wm)(a,{modelValue:(0,d.SU)(I).ipend,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,d.SU)(I).ipend=e),placeholder:"请输入IP范围"},null,8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,d.SU)(D)?((0,i.wg)(),(0,i.j4)(c,{key:2,label:"设备类型",prop:"groupid"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:(0,d.SU)(I).groupid,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,d.SU)(I).groupid=e),placeholder:"请选择设备类型",clearable:"",class:"form-select",filterable:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,d.SU)(R),(e=>((0,i.wg)(),(0,i.j4)(f,{key:e.groupid,label:e.name,value:e.groupid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,d.SU)(Z)?((0,i.wg)(),(0,i.j4)(c,{key:3,class:"delay-form",label:"更新间隔",prop:"delay"},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{modelValue:(0,d.SU)(I).delay,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,d.SU)(I).delay=e),class:"input-select",placeholder:"请输入",controls:!1},null,8,["modelValue"]),(0,i.Wm)(h,{modelValue:(0,d.SU)(I).delayUnit,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,d.SU)(I).delayUnit=e),placeholder:"请选择",class:"input-append"},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)(P,(e=>(0,i.Wm)(f,{key:e.key,label:e.name,value:e.key},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(c,{label:"发现方式",prop:"dchecks"},{default:(0,i.w5)((()=>[(0,i.Wm)(m["default"],{"is-pagination":!1,"is-selection":!1,"column-list":B,"list-data":(0,d.SU)(I).dchecks,"list-loading":!1,"class-name":"discovery-mode"},{operation:(0,i.w5)((({row:e,index:t})=>[(0,i.Wm)(g,{text:"",type:"primary",onClick:t=>G(e)},{default:(0,i.w5)((()=>[(0,i.Uk)(" 编辑 ")])),_:2},1032,["onClick"]),0===t&&(0,d.SU)(K)?.query.druleid?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(g,{key:0,text:"",type:"primary",onClick:t=>$(e)},{default:(0,i.w5)((()=>[(0,i.Uk)(" 删除 ")])),_:2},1032,["onClick"]))])),_:1},8,["list-data"]),(0,i.Wm)(g,{disabled:4===(0,d.SU)(I).dchecks?.length,class:"add-discovery-mode",plain:"",onClick:F},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{icon:"add-fill"}),(0,i.Uk)(" 添加发现方式 ")])),_:1},8,["disabled"])])),_:1}),(0,i.Wm)(c,{label:"分配机房",prop:"houseid"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:(0,d.SU)(I).houseid,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,d.SU)(I).houseid=e),placeholder:"请选择分配机房",clearable:"",class:"form-select"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,d.SU)(O),(e=>((0,i.wg)(),(0,i.j4)(f,{key:e.houseid,label:e.name,value:e.houseid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,d.SU)(q)?((0,i.wg)(),(0,i.j4)(c,{key:4,label:"设备负责人",prop:"userid"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:(0,d.SU)(I).userid,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,d.SU)(I).userid=e),placeholder:"请选择设备负责人",clearable:"",class:"form-select"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,d.SU)(Y),(e=>((0,i.wg)(),(0,i.j4)(f,{key:e.userid,label:e.username,value:e.userid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(c,{label:"启用状态",prop:"status"},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{modelValue:(0,d.SU)(I).status,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,d.SU)(I).status=e),"active-value":"0","inactive-value":"1"},null,8,["modelValue"])])),_:1}),(0,d.SU)(C)?.length?((0,i.wg)(),(0,i.j4)(c,{key:5},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,d.SU)(C),((e,t)=>((0,i.wg)(),(0,i.j4)(g,{key:t,type:e.type,onClick:t=>Q(e)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,p.zw)(e.name),1)])),_:2},1032,["type","onClick"])))),128))])),_:1})):(0,i.kq)("",!0)])),_:1},8,["model"]),(0,d.SU)(L).visible?((0,i.wg)(),(0,i.j4)((0,d.SU)(U),{key:0,"discovery-data":(0,d.SU)(L).data,title:(0,d.SU)(L).title,visible:(0,d.SU)(L).visible,onCancel:X,onConfirm:J},null,8,["discovery-data","title","visible"])):(0,i.kq)("",!0)])}}};function U(e){e.__source="src/components/DiscoverInfo.vue"}var I=a(83744);"function"===typeof U&&U(S);const C=(0,I.Z)(S,[["__scopeId","data-v-12a9a229"]]);var Z=C}}]);