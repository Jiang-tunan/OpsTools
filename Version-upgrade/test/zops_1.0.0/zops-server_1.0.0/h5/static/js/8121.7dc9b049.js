/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[8121,6332],{79803:function(e,t,a){a.d(t,{Fh:function(){return r},ZC:function(){return l},cv:function(){return o},dW:function(){return c},i0:function(){return i},mY:function(){return s}});var n=a(52806);function o(e){return(0,n.Z)({params:{method:"problem.get",data:{selectAcknowledges:"extend",selectTags:"extend",selectSuppressionData:"extend",sortfield:"clock",sortorder:"DESC",...e}}})}function r(e){return(0,n.Z)({params:{method:"event.acknowledge",data:e}})}function i(e){return(0,n.Z)({params:{method:"action.create",data:e}})}function l(e){return(0,n.Z)({params:{method:"action.update",data:e}})}function s(e){return(0,n.Z)({params:{method:"action.get",data:e}})}function c(e){return(0,n.Z)({params:{method:"action.delete",data:e}})}},30575:function(e,t,a){a.d(t,{h:function(){return n}});const n={"":{name:"全部告警",value:""},0:{name:"未分类",value:0},1:{name:"信息",value:1},2:{name:"警告",value:2},3:{name:"一般严重",value:3},4:{name:"严重",value:4},5:{name:"灾难",value:5}}},66449:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var n=a(49530),o=(a(24549),a(80773),a(57658),a(66252)),r=a(2262),i=a(3577),l=a(79803),s=a(5743),c=a(30575),d=a(18907),u=a(22076),m=a(51640),f=a(22201);const p={class:"monitor-details-table"},v=["onClick"];var g={__name:"MonitorDetails",setup(e){const t=(0,o.RC)((()=>Promise.all([a.e(922),a.e(1108),a.e(6860),a.e(1463)]).then(a.bind(a,54009)))),g=(0,o.RC)((()=>a.e(6135).then(a.bind(a,96062)))),h=[{prop:"severity",label:"告警等级",sortable:"custom",isRender:!0,width:"110",fixed:"left"},{prop:"delay",label:"状态",isRender:!0,width:"90"},{prop:"host",className:"host-name",label:"设备名称",tooltip:!0},{prop:"ip",label:"IP地址",tooltip:!0,width:"130"},{prop:"name",label:"告警信息",tooltip:!0},{prop:"during_time_str",label:"持续时间",tooltip:!0,width:"110"},{prop:"acknowledged",width:"110",label:"是否确认",isRender:!0},{prop:"acknowledges",className:"operation-log",label:"操作日志",width:"110",isRender:!0},{align:"right",fixed:"right",label:"操作",tooltip:!0,width:"100",prop:"operation",isRender:!0}],w={time_str:"clock"},k={clock:"time_str"},_=(0,f.yj)(),b=(0,o.f3)("$baseTableHeight"),C=(0,r.iH)(null),D=(0,r.iH)({current:1,limit:10,filter:{severity:""},search:{name:""},hostids:[_.query.hostid]}),y=(0,r.qj)({height:b(3)-30,selectRows:[],alarmInfoData:{visible:!1,data:{}},sortfield:null,sortorder:null,equipmentData:{}}),S=e=>{const t=e?.acknowledges[e.acknowledges.length-1]?.message;y.alarmInfoData={visible:!0,data:{eventid:e.eventid,name:e.name,message:t,acknowledges:e.acknowledges,ack_str:e.ack_str,acknowledge:"Yes"===e.ack_str,ignoreAlarm:!!e.delay,alert_delay:e.alert_delay}}};function U(){y.alarmInfoData.visible=!1}const x=e=>{D.value.limit=e,E()},q=e=>{D.value.current=e,E()},I=e=>{y.selectRows=e},R=({prop:e,order:t})=>{y.sortfield=w[e],y.sortorder="ascending"===t?"ASC":"descending"===t?"DESC":"",E()},W=()=>{y.height=(0,u.NC)(C,7.89,"remToPx")},E=()=>{y.loading=!0,y.sortorder?(D.value.sortfield=y.sortfield,D.value.sortorder=y.sortorder):(D.value.sortorder="DESC",D.value.sortfield="clock"),y.alarmData=[],(0,l.cv)(D.value).then((e=>{if(!e.error){for(const a in e)if(Object.hasOwnProperty.call(e,a)){const t=e[a];y.total=Number(t.total),y.alarmData.push(t),t.severity&&(t.severityName=c.h[t.severity].name)}const t=k[D.value.sortfield];"ASC"===D.value.sortorder?y.alarmData.sort((function(e,a){return e[t]>a[t]?1:-1})):"DESC"===D.value.sortorder&&y.alarmData.sort((function(e,a){return e[t]<a[t]?1:-1}))}y.loading=!1})).catch((e=>{console.log("err :>> ",e),y.loading=!1}))};function M(){(0,d.XF)({output:"extend",selectGroups:["groupid","name"],selectIDC:["idcid","name"],selectInterfaces:"extend",selectParentTemplates:"extend",selectHouse:["houseid","name"],getHistory:!0,hostids:[_.query.hostid]}).then((e=>{e.error||(y.equipmentData=e[0])})).catch((e=>{console.log(e)}))}return(0,o.bv)((()=>{W(),E(),M()})),(e,a)=>{const l=n.ElButton;return(0,o.wg)(),(0,o.iD)("div",{ref_key:"monitorRef",ref:C,class:"monitor-details-container"},[(0,o.Wm)(m["default"],{"equipment-data":(0,r.SU)(y).equipmentData},null,8,["equipment-data"]),(0,o._)("div",p,[(0,o.Wm)(s["default"],{"max-height":(0,r.SU)(y).height,"list-loading":(0,r.SU)(y).loading,"list-data":(0,r.SU)(y).alarmData,"column-list":h,total:(0,r.SU)(y).total,"page-no":(0,r.SU)(D).current,"page-size":(0,r.SU)(D).limit,onSizeChange:x,onCurrentChange:q,onSelectRows:I,onSortChange:R},{severity:(0,o.w5)((({row:e})=>[(0,o._)("span",{class:(0,i.C_)(["monitor-details-level-"+e.severity,"monitor-details-level"]),effect:"plain"},(0,i.zw)(e.severityName),3)])),delay:(0,o.w5)((({row:e})=>[(0,o._)("span",{class:(0,i.C_)("monitor-details-status-"+(e.delay?"1":"2"))},(0,i.zw)(e.delay?"问题":"忽略"),3)])),house:(0,o.w5)((({row:e})=>[(0,o.Uk)((0,i.zw)(e?.house?.name||"---"),1)])),acknowledged:(0,o.w5)((({row:e})=>[(0,o._)("span",{class:(0,i.C_)(["ack-str","ack-str-"+(e.acknowledged?"1":"0")]),onClick:t=>S(e)},(0,i.zw)(e.acknowledged?"是":"否"),11,v)])),acknowledges:(0,o.w5)((({row:e})=>[(0,o.Wm)((0,r.SU)(g),{"cloumn-data":e},null,8,["cloumn-data"])])),operation:(0,o.w5)((({row:e})=>[(0,o.Wm)(l,{text:"",type:"primary",onClick:t=>S(e)},{default:(0,o.w5)((()=>[(0,o.Uk)(" 处理 ")])),_:2},1032,["onClick"])])),_:1},8,["max-height","list-loading","list-data","total","page-no","page-size"])]),(0,r.SU)(y).alarmInfoData.visible?((0,o.wg)(),(0,o.j4)((0,r.SU)(t),{key:0,"alarm-info-data":(0,r.SU)(y).alarmInfoData.data,visible:(0,r.SU)(y).alarmInfoData.visible,onCancel:U,onSubmit:E},null,8,["alarm-info-data","visible"])):(0,o.kq)("",!0)],512)}}};function h(e){e.__source="src/views/monitoring-center/equipment-monitoring/device-monitor-info/MonitorDetails.vue"}var w=a(83744);"function"===typeof h&&h(g);const k=(0,w.Z)(g,[["__scopeId","data-v-f453d10e"]]);var _=k},99382:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n=a(48959),o=(a(24549),a(81037),a(13565),a(8734)),r=(a(7553),a(66252)),i=a(3577);const l=e=>((0,r.dD)("data-v-69c5de52"),e=e(),(0,r.Cn)(),e),s={class:"device-monitor-info-detail"},c={class:"back-title"},d=l((()=>(0,r._)("span",{class:"title"},"设备监控",-1))),u=l((()=>(0,r._)("span",{class:"divider"},"/",-1))),m={class:"back-name"},f={class:"device-monitor-info-container"};function p(e,t,a,l,p,v){const g=(0,r.up)("Back"),h=o.gn,w=n.E_,k=n.Q8;return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",c,[(0,r._)("span",{class:"back-btn",onClick:t[0]||(t[0]=(...e)=>l.backEvent&&l.backEvent(...e))},[(0,r.Wm)(h,null,{default:(0,r.w5)((()=>[(0,r.Wm)(g)])),_:1}),d]),u,(0,r._)("span",m,(0,i.zw)(l.route?.query.name||"---"),1)]),(0,r.Wm)(k,{"default-active":l.currentComp,mode:"horizontal",class:"device-monitor-info-menu",onSelect:l.selectMenu},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{index:"MonitorDetails"},{default:(0,r.w5)((()=>[(0,r.Uk)("监控详情")])),_:1}),(0,r.Wm)(w,{index:"MonitorChart"},{default:(0,r.w5)((()=>[(0,r.Uk)("监控图表")])),_:1}),(0,r.Wm)(w,{index:"DeviceInfo"},{default:(0,r.w5)((()=>[(0,r.Uk)("设备信息")])),_:1})])),_:1},8,["default-active","onSelect"]),(0,r._)("div",f,[((0,r.wg)(),(0,r.j4)((0,r.LL)(l.currentComp)))])])}a(57658);var v=a(7628),g=a(66449),h=a(79461),w=a(2262),k=a(22201),_={components:{MonitorChart:v["default"],MonitorDetails:g["default"],DeviceInfo:h["default"]},setup(){const e=(0,w.iH)("MonitorDetails"),t=(0,k.tv)(),a=(0,k.yj)(),n=t=>{e.value=t};function o(){t.push({name:"EquipmentMonitoring"})}return{currentComp:e,selectMenu:n,route:a,backEvent:o}}};function b(e){e.__source="src/views/monitoring-center/equipment-monitoring/device-monitor-info/index.vue"}var C=a(83744);"function"===typeof b&&b(_);const D=(0,C.Z)(_,[["render",p],["__scopeId","data-v-69c5de52"]]);var y=D}}]);