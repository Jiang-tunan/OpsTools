/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[7578,8743,657],{79803:function(e,t,a){a.d(t,{Fh:function(){return l},ZC:function(){return i},cv:function(){return o},dW:function(){return u},i0:function(){return r},mY:function(){return s}});var n=a(52806);function o(e){return(0,n.Z)({params:{method:"problem.get",data:{selectAcknowledges:"extend",selectTags:"extend",selectSuppressionData:"extend",sortfield:"clock",sortorder:"DESC",...e}}})}function l(e){return(0,n.Z)({params:{method:"event.acknowledge",data:e}})}function r(e){return(0,n.Z)({params:{method:"action.create",data:e}})}function i(e){return(0,n.Z)({params:{method:"action.update",data:e}})}function s(e){return(0,n.Z)({params:{method:"action.get",data:e}})}function u(e){return(0,n.Z)({params:{method:"action.delete",data:e}})}},30575:function(e,t,a){a.d(t,{h:function(){return n}});const n={"":{name:"全部告警",value:""},0:{name:"未分类",value:0},1:{name:"信息",value:1},2:{name:"警告",value:2},3:{name:"一般严重",value:3},4:{name:"严重",value:4},5:{name:"灾难",value:5}}},35068:function(e,t,a){a.d(t,{Z:function(){return u}});var n=a(74842),o=(a(24549),a(94851),a(66252));const l={class:"right-panel"};var r=(0,o.aZ)({__name:"VabQueryFormRightPanel",props:{span:{type:Number,default:10}},setup(e){return(t,a)=>{const r=n.Dv;return(0,o.wg)(),(0,o.j4)(r,{lg:e.span,md:24,sm:24,xl:e.span,xs:24},{default:(0,o.w5)((()=>[(0,o._)("div",l,[(0,o.WI)(t.$slots,"default")])])),_:3},8,["lg","xl"])}}});function i(e){e.__source="library/components/VabQueryForm/components/VabQueryFormRightPanel.vue"}"function"===typeof i&&i(r);const s=r;var u=s},48499:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(74842),o=(a(24549),a(94851),a(66252));const l={class:"top-panel"};function r(e,t){const a=n.Dv;return(0,o.wg)(),(0,o.j4)(a,{span:24},{default:(0,o.w5)((()=>[(0,o._)("div",l,[(0,o.WI)(e.$slots,"default")])])),_:3})}function i(e){e.__source="library/components/VabQueryForm/components/VabQueryFormTopPanel.vue"}var s=a(83744);const u={};"function"===typeof i&&i(u);const d=(0,s.Z)(u,[["render",r]]);var c=d},58818:function(e,t,a){a.d(t,{Z:function(){return d}});var n=a(28314),o=(a(24549),a(7436),a(66252));function l(e,t){const a=n.dq;return(0,o.wg)(),(0,o.j4)(a,{class:"vab-query-form",gutter:0},{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"default",{},void 0,!0)])),_:3})}function r(e){e.__source="library/components/VabQueryForm/index.vue"}var i=a(83744);const s={};"function"===typeof r&&r(s);const u=(0,i.Z)(s,[["render",l],["__scopeId","data-v-4d22213e"]]);var d=u},5743:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var n=a(64654),o=(a(24549),a(16135),a(91067)),l=(a(78526),a(47546)),r=(a(49653),a(37965)),i=(a(82880),a(60717),a(66252)),s=a(3577),u=a(2262),d={__name:"CustomTable",props:{columnList:{type:Array,default:()=>[]},listData:{type:Array,default:()=>[]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},total:{type:Number,default:0},pageNo:{type:Number,default:0},pageSize:{type:Number,default:20},maxHeight:{type:[String,Number],default:"auto"},className:{type:String,default:""},idkey:{type:String,default:""},listLoading:{type:Boolean,default:!0},isIndex:{type:Boolean,default:!1},isSelection:{type:Boolean,default:!0},isPagination:{type:Boolean,default:!0},stripe:{type:Boolean,default:!0},spanMethod:{type:Function,default:()=>{}}},emits:["sizeChange","currentChange","selectRows","sortChange","spanMethod"],setup(e,{expose:t,emit:a}){const d=(0,u.iH)(null),c=e=>{a("sizeChange",e)},m=e=>{a("currentChange",e)},p=e=>{a("selectRows",e)},f=e=>{a("sortChange",e)};function g(e){e&&(console.log("row :>> ",e),d.value.toggleRowSelection(e))}return(0,i.dl)((()=>{d?.value?.doLayout()})),(0,i.bv)((()=>{d.value.doLayout()})),t({tableRef:d,toggleRowSelection:g}),(t,a)=>{const u=l.$Y,g=r.GT,v=l.eI,h=o.R,w=n.t;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.wy)(((0,i.wg)(),(0,i.j4)(v,{ref_key:"tableRef",ref:d,class:(0,s.C_)(["custom-table",e.className]),data:e.listData,border:!0,"row-key":e.idkey,"max-height":e.maxHeight,"span-method":e.spanMethod,stripe:e.stripe,onSelectionChange:p,onSortChange:f},{empty:(0,i.w5)((()=>[(0,i.Wm)(g,{description:"暂无数据"})])),default:(0,i.w5)((()=>[e.isSelection?((0,i.wg)(),(0,i.j4)(u,{key:0,fixed:"left",type:"selection",width:"55"})):(0,i.kq)("",!0),e.isIndex?((0,i.wg)(),(0,i.j4)(u,{key:1,fixed:"left",label:"序号",type:"index",width:"55"})):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columnList,(e=>((0,i.wg)(),(0,i.j4)(u,{key:e.prop,label:e.label,prop:e.prop,"show-overflow-tooltip":e.tooltip,"class-name":"operation"===e.prop?"operation-btns "+e.className:e.className,align:e.align?e.align:"left",sortable:e.sortable,width:e.width,"min-width":e.minWidth,fixed:"true"==e.fixed||"right"==e.fixed&&"right"},(0,i.Nv)({_:2},[e.isHeaderRender?{name:"header",fn:(0,i.w5)((()=>[(0,i.WI)(t.$slots,e.prop+"Header",{column:e})])),key:"0"}:void 0,e.isRender?{name:"default",fn:(0,i.w5)((({row:a,$index:n,column:o})=>[(0,i.WI)(t.$slots,e.prop,{row:a,index:n,column:o})])),key:"1"}:{name:"default",fn:(0,i.w5)((({row:t})=>[(0,i._)("span",{class:"name"},(0,s.zw)(t[e.prop]||"---"),1)])),key:"2"}]),1032,["label","prop","show-overflow-tooltip","class-name","align","sortable","width","min-width","fixed"])))),128))])),_:3},8,["class","data","row-key","max-height","span-method","stripe"])),[[w,e.listLoading]]),e.isPagination?((0,i.wg)(),(0,i.j4)(h,{key:0,"current-page":e.pageNo,layout:e.layout,"page-size":e.pageSize,total:e.total,onCurrentChange:m,onSizeChange:c},null,8,["current-page","layout","page-size","total"])):(0,i.kq)("",!0)],64)}}};function c(e){e.__source="src/components/CustomTable.vue"}var m=a(83744);"function"===typeof c&&c(d);const p=(0,m.Z)(d,[["__scopeId","data-v-bdd84b16"]]);var f=p},196:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var n=a(58818),o=a(35068),l=a(49530),r=(a(24549),a(80773),a(48499)),i=a(21211),s=(a(12791),a(57847)),u=(a(43872),a(6715),a(38492)),d=(a(94687),a(79303),a(57658),a(66252)),c=a(49963),m=a(2262),p=a(3577),f=a(79803),g=a(5743),v=a(30575);const h=["onClick"];var w={__name:"index",setup(e){const t=(0,d.RC)((()=>Promise.all([a.e(922),a.e(1108),a.e(6860),a.e(1463)]).then(a.bind(a,54009)))),w=(0,d.RC)((()=>a.e(6135).then(a.bind(a,96062)))),y=[{prop:"severity",label:"告警等级",sortable:"custom",isRender:!0,minWidth:"110",fixed:"left"},{prop:"delay",label:"状态",isRender:!0,minWidth:"110"},{prop:"time_str",label:"报警时间",sortable:"custom",tooltip:!0,minWidth:"110"},{prop:"host",className:"host-name",label:"设备名称",tooltip:!0},{prop:"name",label:"告警信息",tooltip:!0},{prop:"ip",label:"IP地址",tooltip:!0},{prop:"during_time_str",label:"持续时间",tooltip:!0,minWidth:"110"},{prop:"recovery_time_str",label:"恢复时间",sortable:"custom",minWidth:"110",tooltip:!0},{prop:"house",label:"所属机房",isRender:!0,tooltip:!0},{prop:"acknowledged",label:"是否确认",isRender:!0},{prop:"acknowledges",className:"operation-log",label:"操作日志",isRender:!0},{align:"right",fixed:"right",label:"操作",tooltip:!0,width:"100",prop:"operation",isRender:!0}],b={severity:"severity",time_str:"clock",recovery_time_str:"r_clock"},_={severity:"severity",clock:"time_str",r_clock:"recovery_time_str"},k=(0,d.f3)("$baseTableHeight"),S=(0,m.iH)(null),C=(0,m.iH)({current:1,limit:10,filter:{severity:""},search:{name:""}}),x=(0,m.qj)({height:k(3)-30,selectRows:[],alarmInfoData:{visible:!1,data:{}},sortfield:null,sortorder:null});(0,d.bv)((()=>{z(),j()}));const W=e=>{const t=e?.acknowledges[e.acknowledges.length-1]?.message;x.alarmInfoData={visible:!0,data:{eventid:e.eventid,name:e.name,message:t,acknowledges:e.acknowledges,ack_str:e.ack_str,acknowledge:"Yes"===e.ack_str,ignoreAlarm:!!e.delay,alert_delay:e.alert_delay}}};function D(){x.alarmInfoData.visible=!1}const R=e=>{C.value.limit=e,j()},U=e=>{C.value.current=e,j()},Z=()=>{C.value.current=1,j()},I=e=>{x.selectRows=e},N=({prop:e,order:t})=>{x.sortfield=b[e],x.sortorder="ascending"===t?"ASC":"descending"===t?"DESC":"",j()},z=()=>{x.height=S.value.offsetHeight-32-48-48},j=()=>{x.loading=!0,x.sortorder?(C.value.sortfield=x.sortfield,C.value.sortorder=x.sortorder):(C.value.sortorder="DESC",C.value.sortfield="clock"),x.alarmData=[],(0,f.cv)(C.value).then((e=>{if(!e.error){for(const a in e)if(Object.hasOwnProperty.call(e,a)){const t=e[a];x.total=Number(t.total),x.alarmData.push(t),t.severity&&(t.severityName=v.h[t.severity].name)}const t=_[C.value.sortfield];"ASC"===C.value.sortorder?x.alarmData.sort((function(e,a){return e[t]>a[t]?1:-1})):"DESC"===C.value.sortorder&&x.alarmData.sort((function(e,a){return e[t]<a[t]?1:-1}))}x.loading=!1})).catch((e=>{console.log("err :>> ",e),x.loading=!1}))};function H(){}return(e,a)=>{const f=u.BT,b=u.ElSelect,_=i.nH,k=s.EZ,z=i.ly,V=r.Z,q=l.ElButton,F=o.Z,P=n.Z;return(0,d.wg)(),(0,d.iD)("div",{ref_key:"alarmRef",ref:S,class:"alarm-container"},[(0,d.Wm)(P,null,{default:(0,d.w5)((()=>[(0,d.Wm)(V,{span:12},{default:(0,d.w5)((()=>[(0,d.Wm)(z,{class:"query-info-form",inline:"","label-width":"0px",onSubmit:a[2]||(a[2]=(0,c.iM)((()=>{}),["prevent"]))},{default:(0,d.w5)((()=>[(0,d.Wm)(_,{label:"",class:"form-status"},{default:(0,d.w5)((()=>[(0,d.Wm)(b,{modelValue:(0,m.SU)(C).filter.severity,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,m.SU)(C).filter.severity=e),onChange:Z},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)((0,m.SU)(v.h),((e,t)=>((0,d.wg)(),(0,d.j4)(f,{key:t,label:e.name,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,d.Wm)(_,{label:"",class:"form-name"},{default:(0,d.w5)((()=>[(0,d.Wm)(k,{modelValue:(0,m.SU)(C).search.name,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,m.SU)(C).search.name=e),placeholder:"请输入内容搜索",clearable:"",onChange:Z},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,d.Wm)(F,{span:12},{default:(0,d.w5)((()=>[(0,d.Wm)(q,{onClick:H},{default:(0,d.w5)((()=>[(0,d.Uk)("导出")])),_:1})])),_:1})])),_:1}),(0,d.Wm)(g["default"],{ref:"userTableRef","max-height":(0,m.SU)(x).height,"class-name":"alarm-table","list-loading":(0,m.SU)(x).loading,"list-data":(0,m.SU)(x).alarmData,"column-list":y,total:(0,m.SU)(x).total,"is-index":!0,"page-no":(0,m.SU)(C).current,"page-size":(0,m.SU)(C).limit,onSizeChange:R,onCurrentChange:U,onSelectRows:I,onSortChange:N},{severity:(0,d.w5)((({row:e})=>[(0,d._)("span",{class:(0,p.C_)(["alarm-level-"+e.severity,"alarm-level"]),effect:"plain"},(0,p.zw)(e.severityName),3)])),delay:(0,d.w5)((({row:e})=>[(0,d._)("span",{class:(0,p.C_)("alarm-status-"+(e.delay?"1":"2"))},(0,p.zw)(e.delay?"问题":"忽略"),3)])),house:(0,d.w5)((({row:e})=>[(0,d.Uk)((0,p.zw)(e?.house?.name||"---"),1)])),acknowledged:(0,d.w5)((({row:e})=>[(0,d._)("span",{class:(0,p.C_)(["ack-str","ack-str-"+(e.acknowledged?"1":"0")]),onClick:t=>W(e)},(0,p.zw)(e.acknowledged?"是":"否"),11,h)])),acknowledges:(0,d.w5)((({row:e})=>[(0,d.Wm)((0,m.SU)(w),{"cloumn-data":e},null,8,["cloumn-data"])])),operation:(0,d.w5)((({row:e})=>[(0,d.Wm)(q,{text:"",type:"primary",onClick:t=>W(e)},{default:(0,d.w5)((()=>[(0,d.Uk)(" 详情 ")])),_:2},1032,["onClick"])])),_:1},8,["max-height","list-loading","list-data","total","page-no","page-size"]),(0,m.SU)(x).alarmInfoData.visible?((0,d.wg)(),(0,d.j4)((0,m.SU)(t),{key:0,"alarm-info-data":(0,m.SU)(x).alarmInfoData.data,visible:(0,m.SU)(x).alarmInfoData.visible,onCancel:D,onSubmit:j},null,8,["alarm-info-data","visible"])):(0,d.kq)("",!0)],512)}}};function y(e){e.__source="src/views/problem/index.vue"}var b=a(83744);"function"===typeof y&&y(w);const _=(0,b.Z)(w,[["__scopeId","data-v-0b7d9842"]]);var k=_}}]);