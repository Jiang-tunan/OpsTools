/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[3385,4196],{24831:function(e,t,a){a.r(t),a.d(t,{default:function(){return U}});var n=a(49530),i=(a(24549),a(80773),a(50952)),l=(a(83646),a(47301)),o=(a(52783),a(58818)),r=a(48499),s=a(21211),m=(a(12791),a(6715),a(57847)),d=(a(43872),a(57658),a(66252)),c=a(2262),u=a(49963),p=a(3577),g=a(5743),h=a(83954),v=a(22076),f=a(22201);const b=["onClick"];var y={__name:"MonitorItem",setup(e){const t=(0,d.RC)((()=>Promise.all([a.e(922),a.e(4736)]).then(a.bind(a,66468)))),y=(0,f.yj)(),w=(0,f.tv)(),_=(0,d.f3)("$baseTableHeight"),k=(0,c.iH)(null),U=(0,c.iH)(null),C=[{label:"监控项",prop:"name",tooltip:!0},{label:"告警指标",prop:"triggers",className:"blue-text",tooltip:!0,isRender:!0},{label:"间隔",prop:"delay",tooltip:!0},{label:"历史记录",prop:"history",tooltip:!0},{label:"趋势",prop:"trends",tooltip:!0,width:"200"},{label:"类型",prop:"type_str",tooltip:!0},{label:"启用状态",prop:"status",isRender:!0},{align:"right",fixed:"right",label:"操作",tooltip:!0,width:"100",prop:"operation",isRender:!0}],S=(0,c.iH)({current:1,limit:10,search:{name:""},output:"extend",selectTriggers:!0,hostids:[y?.query?.templateid]}),I=(0,c.qj)({height:_(3)-30,itemsdata:[],listLoading:!0,total:0,monitorItemData:{title:"监控项编辑",type:"new",visible:!1,data:{itemid:"",type:"",name:"",history:"",trends:"",trendsUnit:"d",selectTrends:"noTrend",delay:"",enable:!0,description:""}}}),W=async()=>{I.listLoading=!0,I.itemsdata=[],(0,h.$C)(S.value).then((e=>{!e.error&&e.length&&(I.itemsdata=e,I.total=Number(e[0]?.total)),I.listLoading=!1})).catch((e=>{console.log(e),I.listLoading=!1}))},D=e=>{S.value.limit=e,I.total=0,W()},T=e=>{S.value.current=e,W()},x=()=>{S.value.current=1,W()},q=()=>{I.height=(0,v.NC)(k,1/3+8.125,"remToPx")},L=e=>{const t=e.delay.slice(0,e.delay.length-1),a=e.delay.slice(-1),n=e.history.slice(0,e.history.length-1),i=e.history.slice(-1),l="0"===e.trends?0:e.trends.slice(0,e.trends.length-1),o="0"===e.trends?"d":e.trends.slice(-1);I.monitorItemData={title:"监控项编辑",type:"edit",visible:!0,data:{itemid:e.itemid,type:e.type,name:e.name,history:n||0,trends:l,delay:t||0,enable:e.isopen,selectTrends:0===l?"noTrend":"custom",description:e.description,delayUnit:a||"m",historyUnit:i||"d",trendsUnit:o||"d"}}};function M(){I.monitorItemData.visible=!1}function z(e){(0,h.yj)({itemid:e.itemid,enable:e.isopen}).then((e=>{e.error&&W()})).catch((e=>{console.log("err :>> ",e),W()}))}function E(e){"0"!==e.triggers&&w.push({name:"TemplateDetail",query:{templateid:y?.query?.templateid,tab:"alarm",name:y?.query?.name,itemid:e.itemid}})}return(0,d.wF)((()=>{window.addEventListener("resize",q)})),(0,d.Ah)((()=>{window.removeEventListener("resize",q)})),(0,d.bv)((()=>{q(),W()})),(e,a)=>{const h=m.EZ,v=s.nH,f=s.ly,y=r.Z,w=o.Z,_=l.OX,q=i.Q0,V=n.ElButton;return(0,d.wg)(),(0,d.iD)("div",{ref_key:"itemsContainer",ref:k,class:"template-content"},[(0,d.Wm)(w,null,{default:(0,d.w5)((()=>[(0,d.Wm)(y,{span:12},{default:(0,d.w5)((()=>[(0,d.Wm)(f,{class:"query-info-form",inline:"","label-width":"0px",model:(0,c.SU)(S),onSubmit:a[1]||(a[1]=(0,u.iM)((()=>{}),["prevent"]))},{default:(0,d.w5)((()=>[(0,d.Wm)(v,{label:"",class:"form-name"},{default:(0,d.w5)((()=>[(0,d.Wm)(h,{modelValue:(0,c.SU)(S).search.name,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,c.SU)(S).search.name=e),placeholder:"请输入关键字搜索",onChange:x},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1}),(0,d.Wm)(g["default"],{ref_key:"itemsTableRef",ref:U,"max-height":(0,c.SU)(I).height,"class-name":"items-table","list-loading":(0,c.SU)(I).listLoading,"list-data":(0,c.SU)(I).itemsdata,"column-list":C,total:(0,c.SU)(I).total,"is-selection":!1,"page-no":(0,c.SU)(S).current,"page-size":(0,c.SU)(S).limit,onSizeChange:D,onCurrentChange:T},{triggers:(0,d.w5)((({row:e})=>[(0,d._)("span",{class:"alarm-table-btn",onClick:t=>E(e)}," 告警指标 "+(0,p.zw)(e.triggers||0),9,b)])),status:(0,d.w5)((({row:e})=>[(0,d.Wm)(q,{content:e.isopen?"点击禁用":"点击启用",enterable:!1,placement:"top"},{default:(0,d.w5)((()=>[(0,d.Wm)(_,{modelValue:e.isopen,"onUpdate:modelValue":t=>e.isopen=t,"active-value":!0,"inactive-value":!1,onChange:t=>z(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1032,["content"])])),operation:(0,d.w5)((({row:e})=>[(0,d.Wm)(V,{text:"",type:"primary",onClick:t=>L(e)},{default:(0,d.w5)((()=>[(0,d.Uk)(" 编辑 ")])),_:2},1032,["onClick"])])),_:1},8,["max-height","list-loading","list-data","total","page-no","page-size"]),(0,c.SU)(I).monitorItemData.visible?((0,d.wg)(),(0,d.j4)((0,c.SU)(t),{key:0,"monitor-item-data":(0,c.SU)(I).monitorItemData.data,title:(0,c.SU)(I).monitorItemData.title,type:(0,c.SU)(I).monitorItemData.type,visible:(0,c.SU)(I).monitorItemData.visible,onCancel:M,onConfirm:W},null,8,["monitor-item-data","title","type","visible"])):(0,d.kq)("",!0)],512)}}};function w(e){e.__source="src/views/system/template-management/MonitorItem.vue"}var _=a(83744);"function"===typeof w&&w(y);const k=(0,_.Z)(y,[["__scopeId","data-v-2489f584"]]);var U=k},90203:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var n=a(48959),i=(a(24549),a(81037),a(13565),a(8734)),l=(a(7553),a(66252)),o=a(3577);const r=e=>((0,l.dD)("data-v-65bdea7a"),e=e(),(0,l.Cn)(),e),s={class:"template-detail"},m={class:"back-title"},d=r((()=>(0,l._)("span",{class:"title"},"模板管理",-1))),c=r((()=>(0,l._)("span",{class:"divider"},"/",-1))),u={class:"back-name"},p={class:"template-container"};function g(e,t,a,r,g,h){const v=(0,l.up)("Back"),f=i.gn,b=n.E_,y=n.Q8;return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",m,[(0,l._)("span",{class:"back-btn",onClick:t[0]||(t[0]=(...e)=>r.backEvent&&r.backEvent(...e))},[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),d]),c,(0,l._)("span",u,(0,o.zw)(r.route?.query?.name),1)]),(0,l.Wm)(y,{"default-active":r.currentComp,mode:"horizontal",class:"template-menu",onSelect:r.selectMenu},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{index:"MonitorItem"},{default:(0,l.w5)((()=>[(0,l.Uk)("监控项")])),_:1}),(0,l.Wm)(b,{index:"AlarmIndicator"},{default:(0,l.w5)((()=>[(0,l.Uk)("告警指标")])),_:1})])),_:1},8,["default-active","onSelect"]),(0,l._)("div",p,[((0,l.wg)(),(0,l.j4)((0,l.LL)(r.currentComp)))])])}a(57658);var h=a(65781),v=a(87436),f=a(24831),b=a(22201),y=a(2262),w={components:{AlarmIndicator:v["default"],MonitorItem:f["default"],Back:h.Back},setup(){const e=(0,b.tv)(),t=(0,b.yj)(),a=(0,y.iH)(t?.query?.tab||"MonitorItem"),n=e=>{a.value=e};function i(){e.push({name:"TemplateManagement"})}return{currentComp:a,selectMenu:n,backEvent:i,route:t}}};function _(e){e.__source="src/views/system/template-management/TemplateDetail.vue"}var k=a(83744);"function"===typeof _&&_(w);const U=(0,k.Z)(w,[["render",g],["__scopeId","data-v-65bdea7a"]]);var C=U}}]);