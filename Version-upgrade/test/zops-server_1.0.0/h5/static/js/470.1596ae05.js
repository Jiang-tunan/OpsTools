/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[470],{90626:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var l=n(49530),a=(n(24549),n(80773),n(46538)),i=(n(92719),n(20822),n(23202)),o=(n(61033),n(57658),n(66252)),s=n(2262),r=n(3577),u=n(39049),d=n(12688),m=n(5743),c=n(50837),p={__name:"FunPermissionSet",props:{roleData:{type:Object,default:()=>({})},title:{type:String,default:"功能权限设置"},type:{type:String,default:"new"},visible:{type:Boolean,default:!1}},emits:["cancel","confirm"],setup(e,{emit:t}){const n=e,p=(0,o.f3)("$baseMessage"),f=[{label:"模块",prop:"module",tooltip:!0,isRender:!0},{isHeaderRender:!0,label:"页面",prop:"page",tooltip:!0,isRender:!0,className:"page-column"}],{title:h,visible:g,roleData:w}=(0,s.BK)(n),v=(0,s.qj)({permissionVal:[],listLoading:!0,permissionInfoData:[],frontsData:[],checkAll:!1,isIndeterminate:!1}),U=({row:e,columnIndex:t})=>0===t?1===e.level?[e?.children?.length+1,1]:[0,0]:e?.children?.length?[0,0]:[1,1];function k(){t("cancel")}function b(){const e={name:w.value.name,description:w.value.description,roleid:w.value.roleid,type:"1",rules:{front:[]}};for(let t=0;t<w.value.permission.length;t++)e.rules.front.push({name:w.value.permission[t],status:"1"});(0,d.ul)(e).then((e=>{e?.error||(p("设置功能权限成功","success"),t("cancel"),t("confirm"))}))}function _(e,t){for(let n=0;n<e.length;n++){const l=e[n];l.meta.title&&!l.meta.hidden&&v.permissionInfoData.push({children:l.children,title:l.meta.title,name:l.name,level:t}),l.children&&_(l.children,2),(2===t||l.meta.title&&!l.children?.length)&&v.frontsData.push(l.name)}v.listLoading=!1}function S(){const e=w.value.permission.length;v.checkAll=e===v.frontsData.length,v.isIndeterminate=e>0&&e<v.frontsData.length}function y(e){w.value.permission=e?v.frontsData:[],v.isIndeterminate=!1}return(0,o.bv)((()=>{_(c.aP,1),(0,o.Y3)((()=>{S()}))})),(e,t)=>{const n=i.v,d=a.ElCheckbox,c=a.z5,p=l.ElButton;return(0,o.wg)(),(0,o.j4)((0,s.SU)(u["default"]),{modelValue:(0,s.SU)(g),"onUpdate:modelValue":[t[2]||(t[2]=e=>(0,s.dq)(g)?g.value=e:null),k],title:(0,s.SU)(h),width:"62.5rem",class:"fun-permission-set-dialog"},{footer:(0,o.w5)((()=>[(0,o.Wm)(p,{onClick:k},{default:(0,o.w5)((()=>[(0,o.Uk)("取消")])),_:1}),(0,o.Wm)(p,{type:"primary",onClick:b},{default:(0,o.w5)((()=>[(0,o.Uk)("确定")])),_:1})])),default:(0,o.w5)((()=>[(0,o.Wm)(n,{title:"功能权限仅影响页面功能，管理应用的发布权限请在发布权限中设置。权限更改成功后会强制属于该角色的账户重新登录。",type:"info","show-icon":""}),(0,o.Wm)(m["default"],{ref:"permissionTableRef","list-loading":(0,s.SU)(v).listLoading,"list-data":(0,s.SU)(v).permissionInfoData,"column-list":f,"is-pagination":!1,"is-selection":!1,stripe:!1,"span-method":U,"class-name":"permission-table"},{pageHeader:(0,o.w5)((({column:e})=>[(0,o.Wm)(d,{modelValue:(0,s.SU)(v).checkAll,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,s.SU)(v).checkAll=e),indeterminate:(0,s.SU)(v).isIndeterminate,onChange:y},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.label),1)])),_:2},1032,["modelValue","indeterminate"])])),module:(0,o.w5)((({row:e})=>[(0,o.Uk)((0,r.zw)(e.title),1)])),page:(0,o.w5)((({row:e})=>[(0,o.Wm)(c,{modelValue:(0,s.SU)(w).permission,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,s.SU)(w).permission=e),onChange:S},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{label:e.name},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.title),1)])),_:2},1032,["label"])])),_:2},1032,["modelValue"])])),_:1},8,["list-loading","list-data"])])),_:1},8,["modelValue","title"])}}};function f(e){e.__source="src/views/system/role/components/FunPermissionSet.vue"}var h=n(83744);"function"===typeof f&&f(p);const g=(0,h.Z)(p,[["__scopeId","data-v-28a89ffd"]]);var w=g}}]);