/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[9070],{93981:function(e,t,o){o.r(t),o.d(t,{default:function(){return f}});var a=o(49530),l=(o(24549),o(80773),o(21211)),n=(o(12791),o(6715),o(38492)),i=(o(94687),o(79303),o(57658),o(66252)),s=o(2262),c=o(39049),r=o(18907),u={__name:"AllocationTemplate",props:{allocationData:{type:Object,default:()=>({})},title:{type:String,default:"分配监控模板"},visible:{type:Boolean,default:!1}},emits:["cancel","confirm"],setup(e,{emit:t}){const o=e,u={name:[{required:!0,message:"请选择监控模板",trigger:"change"}]},d=((0,i.f3)("$baseMessage"),(0,s.iH)(null)),{title:p,visible:m,allocationData:f}=(0,s.BK)(o),g=(0,s.qj)({hostGroupList:[]});function w(){(0,r.v0)({output:["name","groupid"]}).then((e=>{if(!e.error)for(const t in e)if(Object.hasOwnProperty.call(e,t)){const o=e[t];g.hostGroupList.push(o)}g.loading=!1})).catch((e=>{console.log("err :>> ",e),g.loading=!1}))}function h(){t("cancel")}function b(){d.value.validate((e=>{e&&(t("cancel"),t("confirm"))}))}return(0,i.bv)((()=>{w()})),(e,t)=>{const o=n.BT,r=n.ElSelect,w=l.nH,v=l.ly,_=a.ElButton;return(0,i.wg)(),(0,i.j4)((0,s.SU)(c["default"]),{modelValue:(0,s.SU)(m),"onUpdate:modelValue":[t[1]||(t[1]=e=>(0,s.dq)(m)?m.value=e:null),h],title:(0,s.SU)(p),width:"30rem"},{footer:(0,i.w5)((()=>[(0,i.Wm)(_,{onClick:h},{default:(0,i.w5)((()=>[(0,i.Uk)("取消")])),_:1}),(0,i.Wm)(_,{type:"primary",onClick:b},{default:(0,i.w5)((()=>[(0,i.Uk)("确定")])),_:1})])),default:(0,i.w5)((()=>[(0,i.Wm)(v,{ref_key:"allocationFormRef",ref:d,"label-position":"top",model:(0,s.SU)(f),rules:u},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{label:"选择监控模板",prop:"monitoringid"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{modelValue:(0,s.SU)(f).monitoringid,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,s.SU)(f).monitoringid=e),placeholder:"请选择监控模板",class:"input-select"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,s.SU)(g).hostGroupList,(e=>((0,i.wg)(),(0,i.j4)(o,{key:e.groupid,label:e.name,value:e.groupid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])}}};function d(e){e.__source="src/components/AllocationTemplate.vue"}var p=o(83744);"function"===typeof d&&d(u);const m=(0,p.Z)(u,[["__scopeId","data-v-1b9009e8"]]);var f=m},69070:function(e,t,o){o.r(t),o.d(t,{default:function(){return U}});var a=o(31709),l=(o(24549),o(26938),o(49530)),n=(o(80773),o(38492)),i=(o(94687),o(79303),o(50952)),s=(o(83646),o(57658),o(66252)),c=o(2262),r=o(3577),u=o(5743),d=o(93981),p=o(18907),m=o(22076),f=o(22201);const g={class:"scan-info-container"},w={class:"operation-btns"},h={key:1,class:"create-result-content"};var b={__name:"ScanInfo",props:{deviceDiscoveryRef:{type:Object,default:()=>({})}},emits:["cancel"],setup(e,{emit:t}){const o=e,b=(0,f.tv)(),v=(0,c.iH)(null),_=(0,s.f3)("$baseTableHeight"),y=(0,s.f3)("$baseConfirm"),U=(0,c.qj)({listLoading:!0,scanData:[],hostGroupList:[],selectRows:[],showStatus:!0,height:_(3)-30,allocationData:{visible:!1,data:{monitoringid:""}}}),{deviceDiscoveryRef:k}=(0,c.BK)(o),S=[{label:"设备名称",prop:"name",tooltip:!0},{label:"IP 地址",width:"150",prop:"ip",tooltip:!0},{label:"发现方式",width:"200",prop:"protocal",tooltip:!0,isRender:!0},{label:"厂商",prop:"manufacturer",tooltip:!0,isRender:!0},{label:"型号",width:"200",prop:"physical_model",tooltip:!0},{label:"监控模板（必选）",prop:"groups",width:"200",isRender:!0,isHeaderRender:!0}],D=e=>{U.selectRows=e},L=()=>{U.height=(0,m.NC)(k,12.1,"remToPx")};function W(){U.listLoading=!0,(0,p.XF)({output:"extend",selectManufacturer:["name"],selectGroups:"extend",selectInterfaces:"extend",selectModelType:"extend",discover_hosts:!0}).then((e=>{!e.error&&e.length&&(e.map((e=>{e.groupid=e.groups[0]?.groupid||""})),U.scanData=e),U.listLoading=!1})).catch((e=>{console.log(e),U.listLoading=!1}))}function R(){(0,p.v0)({output:["name","groupid"]}).then((e=>{if(!e.error)for(const t in e)if(Object.hasOwnProperty.call(e,t)){const o=e[t];U.hostGroupList.push(o)}U.loading=!1})).catch((e=>{console.log("err :>> ",e),U.loading=!1}))}function C(){y("取消后不保留本次扫描结果以及操作，确定要取消吗？","取消扫描","warning",(async()=>{t("cancel")}))}function j(){const e=U.selectRows.map((e=>({hostid:e.hostid,name:e.name,groupid:e.groupid})));U.allocationData={visible:!0,data:{discoverData:e,monitoringid:""}}}function V(){U.allocationData.visible=!1}function x(){U.selectRows.map((e=>{e.groupid=U.allocationData.data.monitoringid}))}function H(){const e=[];U.scanData.map((t=>{t.groupid&&e.push({hostid:t.hostid,groupid:t.groupid})})),U.listLoading=!0,(0,p.bm)(e).then((e=>{e.error||(U.showStatus=!1),U.listLoading=!1})).catch((e=>{console.log("error :>> ",e),U.listLoading=!1}))}function T(){t("cancel")}function q(){b.push({name:"EquipmentMonitoring"})}return(0,s.wF)((()=>{window.addEventListener("resize",L)})),(0,s.Ah)((()=>{window.removeEventListener("resize",L)})),(0,s.bv)((()=>{W(),R(),(0,s.Y3)((()=>{L()}))})),(e,t)=>{const o=(0,s.up)("vab-icon"),p=i.Q0,m=n.BT,f=n.ElSelect,b=l.ElButton,_=a.b9;return(0,s.wg)(),(0,s.iD)("div",g,[(0,c.SU)(U).showStatus?(0,s.WI)(e.$slots,"default",{key:0},(()=>[(0,s.Wm)(u["default"],{ref_key:"scanTableRef",ref:v,"max-height":(0,c.SU)(U).height,"class-name":"scan-info-table","list-loading":(0,c.SU)(U).listLoading,"list-data":(0,c.SU)(U).scanData,"column-list":S,"is-index":!0,"is-pagination":!1,onSelectRows:D},{groupsHeader:(0,s.w5)((({column:e})=>[(0,s._)("span",null,(0,r.zw)(e.label),1),(0,s.Wm)(p,{content:e.label,placement:"top",effect:"light"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{icon:"question-line"})])),_:2},1032,["content"])])),manufacturer:(0,s.w5)((({row:e})=>[(0,s._)("span",null,(0,r.zw)(e.manufacturer.name||"---"),1)])),protocal:(0,s.w5)((({row:e})=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e?.protocal,((e,t)=>((0,s.wg)(),(0,s.iD)("span",{key:e,class:"protocal-column"},(0,r.zw)(t||"---"),1)))),128))])),groups:(0,s.w5)((({row:e})=>[(0,s.Wm)(f,{modelValue:e.groupid,"onUpdate:modelValue":t=>e.groupid=t,placeholder:"请选择资产类型",clearable:"",filterable:""},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,c.SU)(U).hostGroupList,(e=>((0,s.wg)(),(0,s.j4)(m,{key:e.groupid,label:e.name,value:e.groupid},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1},8,["max-height","list-loading","list-data"]),(0,s._)("div",w,[(0,s.Wm)(b,{onClick:C},{default:(0,s.w5)((()=>[(0,s.Uk)("取消")])),_:1}),(0,s.Wm)(b,{type:"primary",disabled:!(0,c.SU)(U).selectRows.length,onClick:j},{default:(0,s.w5)((()=>[(0,s.Uk)(" 分配设备类型 ")])),_:1},8,["disabled"]),(0,s.Wm)(b,{type:"primary",disabled:!(0,c.SU)(U).scanData.length,onClick:H},{default:(0,s.w5)((()=>[(0,s.Uk)(" 创建监测 ")])),_:1},8,["disabled"])]),(0,c.SU)(U).allocationData.visible?((0,s.wg)(),(0,s.j4)(d["default"],{key:0,"allocation-data":(0,c.SU)(U).allocationData.data,visible:(0,c.SU)(U).allocationData.visible,onCancel:V,onConfirm:x},null,8,["allocation-data","visible"])):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("div",h,[(0,s.Wm)(_,{icon:"success",title:"创建监控成功","sub-title":"资产已成功创建，可以查看了"},{extra:(0,s.w5)((()=>[(0,s.Wm)(b,{type:"primary",onClick:T},{default:(0,s.w5)((()=>[(0,s.Uk)(" 继续添加 ")])),_:1}),(0,s.Wm)(b,{onClick:q},{default:(0,s.w5)((()=>[(0,s.Uk)("查看设备")])),_:1})])),_:1})]))])}}};function v(e){e.__source="src/views/device-discovery/general-discovery/ScanInfo.vue"}var _=o(83744);"function"===typeof v&&v(b);const y=(0,_.Z)(b,[["__scopeId","data-v-7f690c95"]]);var U=y}}]);