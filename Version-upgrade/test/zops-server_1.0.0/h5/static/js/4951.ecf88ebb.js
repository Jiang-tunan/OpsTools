/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[4951],{32134:function(e,a,t){t.d(a,{IP:function(){return l},MB:function(){return s},PN:function(){return o},YZ:function(){return u},iv:function(){return d},qb:function(){return c},tS:function(){return i},vP:function(){return r}});var n=t(52806);function s(e){return(0,n.Z)({params:{method:"idc.get",data:e}})}function l(e){return(0,n.Z)({params:{method:"idc.create",data:e}})}function i(e){return(0,n.Z)({params:{method:"idc.update",data:e}})}function o(e){return(0,n.Z)({params:{method:"idc.delete",data:e}})}function u(e){return(0,n.Z)({params:{method:"house.get",data:e}})}function r(e){return(0,n.Z)({params:{method:"house.create",data:e}})}function d(e){return(0,n.Z)({params:{method:"house.update",data:e}})}function c(e){return(0,n.Z)({params:{method:"house.delete",data:e}})}},24951:function(e,a,t){t.r(a),t.d(a,{default:function(){return k}});var n=t(21211),s=(t(24549),t(12791),t(47301)),l=(t(52783),t(49530)),i=(t(80773),t(38492)),o=(t(94687),t(79303),t(6715),t(57847)),u=(t(43872),t(57658),t(66252)),r=t(2262),d=t(3577),c=t(39049),p=t(18907),m=t(5743),f=t(22076),v=t(32134),h=t(12688),g=t(25498),y={__name:"EquipmentConfig",props:{configData:{type:Object,default:()=>({})},title:{type:String,default:"设备配置"},type:{type:String,default:"edit"},visible:{type:Boolean,default:!1}},emits:["cancel","confirm"],setup(e,{emit:a}){const y=e,_=(0,u.RC)((()=>t.e(5282).then(t.bind(t,35282)))),w=(e,a,t)=>{a?(0,g.h6)(a)?t():t(new Error(translate("请输入正确的IP范围"))):t(new Error(translate("请输入IP范围")))},I={ip:[{required:!0,message:"请输入IP地址",trigger:"blur"},{validator:w,trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],dchecks:[{required:!0,message:"请选择发现方式",trigger:"change"}],groupid:[{required:!0,message:"请选择设备类型",trigger:"change"}]},k=[{prop:"name",label:"检查类型",minWidth:"110"},{align:"right",fixed:"right",label:"操作",width:"150",prop:"operation",isRender:!0}],{title:D,type:U,visible:b,configData:S}=(0,r.BK)(y),V=(0,u.f3)("$baseMessage"),W=(0,r.iH)(null),x=(0,r.iH)([]),q=(0,r.iH)([]),C=(0,r.iH)([]),j=(0,r.iH)([]),H=(0,r.iH)({title:"发现方式",type:"new",visible:!1,data:{}}),P=(0,r.qj)({rulesInfoData:{}});function Z(e){const a=P.rulesInfoData.dchecks.findIndex((a=>a.type===e.type));a>=0&&P.rulesInfoData.dchecks.splice(a,1)}function E(){a("cancel")}function M(){W.value.validate((e=>{if(e){const e=[];P.rulesInfoData.dchecks.map(((a,t)=>{let n={ip:P.rulesInfoData.ip};0===t&&a.items&&(n={...a.items}),"9"===a.type?n.type="1":(n.type="2",n.details||(n.details={}),a.ports&&(n.port=a.ports),"13"===a.type?(n.details.version="3",a.snmpv3_securityname&&(n.details.securityname=a.snmpv3_securityname),a.snmpv3_authpassphrase&&(n.details.authpassphrase=a.snmpv3_authpassphrase),a.snmpv3_privpassphrase&&(n.details.privpassphrase=a.snmpv3_privpassphrase),a.snmpv3_contextname&&(n.details.contextname=a.snmpv3_contextname)):("10"===a.type&&(n.details.version="1"),"11"===a.type&&(n.details.version="2"),a.snmp_community&&(n.details.community=a.snmp_community))),e.push(n)}));const t={name:P.rulesInfoData.name,status:P.rulesInfoData.status,groups:[{groupid:P.rulesInfoData.groupid}],interfaces:e};"edit"===U.value?(t.hostid=P.rulesInfoData.hostid,(0,p.KW)(t).then((e=>{e.error||(V("设置配置更新成功","success"),a("cancel"),a("confirm"))}))):(t.idcid=P.rulesInfoData.idcid,t.houseid=P.rulesInfoData.houseid,t.managerid=P.rulesInfoData.managerid,(0,p.Ld)(t).then((e=>{e.error||(V("设置配置新增成功","success"),a("cancel"),a("confirm"))})))}}))}function B(){P.rulesInfoData.dchecks||(P.rulesInfoData.dchecks=[]);const e=P.rulesInfoData.dchecks.map((e=>e.type));H.value={title:"发现方式",type:"new",visible:!0,data:{selectList:e,ports:"161",snmp_community:"{$SNMP_COMMUNITY}"}}}function N(e){P.rulesInfoData.dchecks||(P.rulesInfoData.dchecks=[]);const a=P.rulesInfoData.dchecks.map((e=>e.type));H.value={title:"发现方式",type:"edit",visible:!0,data:{selectList:a,id:e.id,name:e.name,type:e.type,ports:e.ports,snmp_community:e.snmp_community,snmpv3_securityname:e.snmpv3_securityname,snmpv3_authpassphrase:e.snmpv3_authpassphrase,snmpv3_privpassphrase:e.snmpv3_privpassphrase,snmpv3_contextname:e.snmpv3_contextname}}}function Y(){H.value.visible=!1}function K(){const e={name:H.value.data.name,type:H.value.data.type,ports:H.value.data.ports,snmp_community:H.value.data.snmp_community,snmpv3_securityname:H.value.data.snmpv3_securityname,snmpv3_authpassphrase:H.value.data.snmpv3_authpassphrase,snmpv3_privpassphrase:H.value.data.snmpv3_privpassphrase,snmpv3_contextname:H.value.data.snmpv3_contextname};if(P.rulesInfoData.dchecks||(P.rulesInfoData.dchecks=[]),"new"===H.value.type)e.id=(0,f.BE)(),P.rulesInfoData.dchecks.push(e);else{const a=P.rulesInfoData.dchecks.findIndex((e=>e.id===H.value.data.id));a>-1&&(P.rulesInfoData.dchecks[a]={id:H.value.data.id,...e})}W.value.validateField("dchecks")}function F(){S.value.hostid?(0,p.XF)({output:"extend",selectGroups:"extend",selectHouse:"extend",selectInterfaces:"extend",hostids:[S.value.hostid]}).then((e=>{if(!e.error){const a=e.at(0),t=[];a.interfaces.map((e=>{const a="1"===e.type?"9":"1"===e.details.version?"10":"2"===e.details.version?"11":"13",n="1"===e.type?"AGENT":"1"===e.details.version?"SNMPv1":"2"===e.details.version?"SNMPv2":"SNMPv3";t.push({items:e,type:a,name:n,ports:e.port,ip:e.ip,snmp_community:e.details?.community,snmpv3_securityname:e.details?.securityname,snmpv3_authpassphrase:e.details?.authpassphrase,snmpv3_privpassphrase:e.details?.privpassphrase,snmpv3_contextname:e.details?.contextname})})),P.rulesInfoData={hostid:a.hostid,name:a.name,groupid:a.groups.at(0).groupid,dchecks:t,status:a.status}}})).catch((e=>{console.log("error :>> ",e)})):P.rulesInfoData={hostid:"",name:"",groupid:"",dchecks:[],status:"0"}}function L(){(0,p.v0)({}).then((e=>{j.value.push(...e)})).catch((e=>{console.log("error :>> ",e)}))}function O(e){x.value=[],(0,v.YZ)({output:["hostid","name"],idcids:[e]}).then((e=>{!e.error&&e.length&&(x.value=e)})).catch((e=>{console.log(e)}))}function T(){(0,v.MB)({output:["idcid","name"]}).then((e=>{q.value=e})).catch((e=>{console.log("err :>> ",e)}))}function G(){(0,h.lE)({output:["userid","username"]}).then((e=>{!e.error&&e.length&&(C.value=e)})).catch((e=>{console.log(e)}))}return(0,u.bv)((()=>{F(),L(),"new"===U.value&&(T(),G())})),(e,a)=>{const t=o.EZ,p=n.nH,f=i.BT,v=i.ElSelect,h=l.ElButton,g=(0,u.up)("vab-icon"),y=s.OX,w=n.ly;return(0,u.wg)(),(0,u.j4)((0,r.SU)(c["default"]),{modelValue:(0,r.SU)(b),"onUpdate:modelValue":[a[7]||(a[7]=e=>(0,r.dq)(b)?b.value=e:null),E],title:(0,r.SU)(D),width:"35rem",class:"equipment-config-dialog"},{footer:(0,u.w5)((()=>[(0,u.Wm)(h,{onClick:E},{default:(0,u.w5)((()=>[(0,u.Uk)("取消")])),_:1}),(0,u.Wm)(h,{type:"primary",onClick:M},{default:(0,u.w5)((()=>[(0,u.Uk)((0,d.zw)("new"===(0,r.SU)(U)?"新增":"更新"),1)])),_:1})])),default:(0,u.w5)((()=>[(0,u.Wm)(w,{ref_key:"configForm",ref:W,model:(0,r.SU)(P).rulesInfoData,rules:I,"label-width":"5.5rem",inline:!1},{default:(0,u.w5)((()=>[(0,u.Wm)(p,{label:"设备名称",prop:"name"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:(0,r.SU)(P).rulesInfoData.name,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,r.SU)(P).rulesInfoData.name=e),placeholder:"请输入设备名称"},null,8,["modelValue"])])),_:1}),"new"===(0,r.SU)(U)?((0,u.wg)(),(0,u.j4)(p,{key:0,class:"ip-form",label:"IP地址",prop:"ip"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:(0,r.SU)(P).rulesInfoData.ip,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,r.SU)(P).rulesInfoData.ip=e),placeholder:"请输入IP范围"},null,8,["modelValue"])])),_:1})):(0,u.kq)("",!0),(0,u.Wm)(p,{label:"设备类型",prop:"groupid"},{default:(0,u.w5)((()=>[(0,u.Wm)(v,{modelValue:(0,r.SU)(P).rulesInfoData.groupid,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,r.SU)(P).rulesInfoData.groupid=e),placeholder:"请选择设备类型",clearable:"",class:"form-select",filterable:""},{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,r.SU)(j),(e=>((0,u.wg)(),(0,u.j4)(f,{key:e.groupid,label:e.name,value:e.groupid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.Wm)(p,{label:"发现方式",prop:"dchecks"},{default:(0,u.w5)((()=>[(0,u.Wm)(m["default"],{"is-pagination":!1,"is-selection":!1,"column-list":k,"list-data":(0,r.SU)(P).rulesInfoData.dchecks,"list-loading":!1,"class-name":"discovery-mode"},{operation:(0,u.w5)((({row:e,index:a})=>[(0,u.Wm)(h,{text:"",type:"primary",onClick:a=>N(e)},{default:(0,u.w5)((()=>[(0,u.Uk)(" 编辑 ")])),_:2},1032,["onClick"]),0!==a||"edit"!==(0,r.SU)(U)?((0,u.wg)(),(0,u.j4)(h,{key:0,text:"",type:"primary",onClick:a=>Z(e)},{default:(0,u.w5)((()=>[(0,u.Uk)(" 删除 ")])),_:2},1032,["onClick"])):(0,u.kq)("",!0)])),_:1},8,["list-data"]),(0,u.Wm)(h,{class:"add-discovery-mode",plain:"",onClick:B},{default:(0,u.w5)((()=>[(0,u.Wm)(g,{icon:"add-fill"}),(0,u.Uk)(" 添加发现方式 ")])),_:1})])),_:1}),"new"===(0,r.SU)(U)?((0,u.wg)(),(0,u.j4)(p,{key:1,class:"idc-house-item",label:"数据中心",prop:"idcid"},{default:(0,u.w5)((()=>[(0,u.Wm)(v,{modelValue:(0,r.SU)(P).rulesInfoData.idcid,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,r.SU)(P).rulesInfoData.idcid=e),placeholder:"请选择数据中心",clearable:"",class:"form-select",onChange:O},{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,r.SU)(q),(e=>((0,u.wg)(),(0,u.j4)(f,{key:e.idcid,label:e.name,value:e.idcid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,u.Wm)(v,{modelValue:(0,r.SU)(P).rulesInfoData.houseid,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,r.SU)(P).rulesInfoData.houseid=e),placeholder:"请选择机房",clearable:"",class:"form-select"},{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,r.SU)(x),(e=>((0,u.wg)(),(0,u.j4)(f,{key:e.houseid,label:e.name,value:e.houseid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,u.kq)("",!0),"new"===(0,r.SU)(U)?((0,u.wg)(),(0,u.j4)(p,{key:2,label:"设备负责人",prop:"managerid"},{default:(0,u.w5)((()=>[(0,u.Wm)(v,{modelValue:(0,r.SU)(P).rulesInfoData.managerid,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,r.SU)(P).rulesInfoData.managerid=e),placeholder:"请选择设备负责人",clearable:"",class:"form-select"},{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,r.SU)(C),(e=>((0,u.wg)(),(0,u.j4)(f,{key:e.userid,label:e.username,value:e.userid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,u.kq)("",!0),(0,u.Wm)(p,{label:"启用状态",prop:"status"},{default:(0,u.w5)((()=>[(0,u.Wm)(y,{modelValue:(0,r.SU)(P).rulesInfoData.status,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,r.SU)(P).rulesInfoData.status=e),"active-value":"0","inactive-value":"1"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,r.SU)(H).visible?((0,u.wg)(),(0,u.j4)((0,r.SU)(_),{key:0,"discovery-data":(0,r.SU)(H).data,title:(0,r.SU)(H).title,visible:(0,r.SU)(H).visible,onCancel:Y,onConfirm:K},null,8,["discovery-data","title","visible"])):(0,u.kq)("",!0)])),_:1},8,["modelValue","title"])}}};function _(e){e.__source="src/views/monitoring-center/equipment-monitoring/EquipmentConfig.vue"}var w=t(83744);"function"===typeof _&&_(y);const I=(0,w.Z)(y,[["__scopeId","data-v-94a5ad7e"]]);var k=I}}]);