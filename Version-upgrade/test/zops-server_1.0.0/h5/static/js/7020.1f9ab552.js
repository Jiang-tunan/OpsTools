/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-08-28 11:15:16
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[7020],{37020:function(e,a,t){t.r(a),t.d(a,{default:function(){return b}});var l=t(21211),i=(t(24549),t(12791),t(46538)),o=(t(92719),t(20822),t(49530)),n=(t(80773),t(24434)),s=(t(98476),t(35568),t(6715),t(57847)),u=(t(43872),t(57658),t(66252)),c=t(2262),d=t(49963),r=t(3577),m=t(39049),f=t(79803),v={__name:"index",props:{alarmNotifyInfoData:{type:Object,default:()=>({})},title:{type:String,default:"组织"},type:{type:String,default:"new"},visible:{type:Boolean,default:!1}},emits:["cancel","confirm"],setup(e,{emit:a}){const v=e,p=(0,u.RC)((()=>t.e(7692).then(t.bind(t,77692)))),y=(0,u.RC)((()=>Promise.all([t.e(1108),t.e(6860),t.e(6897),t.e(2641)]).then(t.bind(t,96897)))),h=(0,u.RC)((()=>t.e(8285).then(t.bind(t,28285)))),b=[{name:"设备",key:"0"},{name:"IDC机房",key:"1"},{name:"数据中心",key:"2"}],U=[{key:"1001",name:"短信"},{key:"1002",name:"邮件"},{key:"1004",name:"企业微信"},{key:"1003",name:"钉钉"}],_={name:[{required:!0,message:"请输入通知组名称",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],deviceid:[{required:!0,message:"请选择设备",trigger:"blur"}],userids:[{required:!0,message:"请选择需要通知用户",trigger:"blur"}]},k=(0,u.f3)("$baseMessage"),g=(0,c.iH)(null),{title:w,type:S,visible:D,alarmNotifyInfoData:C}=(0,c.BK)(v),W=(0,c.qj)({selectDeviceData:{data:{},visible:!1},selectRoomData:{data:{},visible:!1},notifyUserData:{data:{},visible:!1},showText:"设备",checkAll:!1,isIndeterminate:!1});function V(){a("cancel")}function R(){g.value.validate((e=>{if(e){const e={name:C.value.name,status:"0",choose_type:C.value.choose_type,filter:{conditions:[]},update_operations:[{opmessage_usr:[],opmessage:[]}]};for(let a=0;a<C.value.notification.length;a++){const t=C.value.notification[a];e.update_operations[0].opmessage.push({mediatypeid:t})}for(let a=0;a<C.value.userdata.length;a++){const t=C.value.userdata[a];e.update_operations[0].opmessage_usr.push({userid:t.userid})}for(let a=0;a<C.value.devicedata.length;a++){const t=C.value.devicedata[a],l="2"===C.value.choose_type?"30":"1"===C.value.choose_type?"29":"1";e.filter.conditions.push({conditiontype:l,operator:"0",value:t})}"new"===S.value?(0,f.i0)(e).then((e=>{e.error||(k("创建成功","success"),a("cancel"),a("confirm"))})):(e.actionid=C.value.actionid,(0,f.ZC)(e).then((e=>{e.error||(k("编辑成功","success"),a("cancel"),a("confirm"))})))}}))}function x(){"0"===C.value.choose_type?W.selectDeviceData={data:{devicedata:C.value.devicedata||[]},visible:!0}:W.selectRoomData={title:"1"===`选择${C.value.choose_type}`?"机房":"数据中心",data:{deviceid:C.value.deviceid||[]},visible:!0}}function I(){W.showText="0"===C.value.choose_type?"设备":"1"===C.value.choose_type?"机房":"数据中心",C.value.devicedata=[],C.value.filter.count=0}function q(){W.selectDeviceData.visible=!1}function j(e){C.value.devicedata=e,C.value.filter.count=e.length}function A(){W.selectRoomData.visible=!1}function z(e){C.value.devicedata=e,C.value.filter.count=e.length}function H(){W.notifyUserData={data:{userids:C.value.userids},visible:!0}}function K(){W.notifyUserData.visible=!1}function N(e){C.value.userdata=e,C.value.update_operations.usercount=e.length,C.value.userids=W.notifyUserData.data.userids}function T(e){const a=[];for(let t=0;t<U.length;t++){const e=U[t];a.push(e.key)}C.value.notification=e?a:[],W.isIndeterminate=!1}function B(){W.checkAll=C.value.notification.length===U.length,W.isIndeterminate=C.value.notification.length>0&&C.value.notification.length<U.length}return(0,u.bv)((()=>{B()})),(e,a)=>{const t=s.EZ,f=l.nH,v=n.rh,k=n.KD,S=o.ElButton,E=i.ElCheckbox,M=i.z5,Z=l.ly;return(0,u.wg)(),(0,u.j4)((0,c.SU)(m["default"]),{modelValue:(0,c.SU)(D),"onUpdate:modelValue":[a[5]||(a[5]=e=>(0,c.dq)(D)?D.value=e:null),V],title:(0,c.SU)(w),width:"35rem"},{footer:(0,u.w5)((()=>[(0,u.Wm)(S,{onClick:V},{default:(0,u.w5)((()=>[(0,u.Uk)("取消")])),_:1}),(0,u.Wm)(S,{type:"primary",onClick:R},{default:(0,u.w5)((()=>[(0,u.Uk)("确定")])),_:1})])),default:(0,u.w5)((()=>[(0,u.Wm)(Z,{ref_key:"alarmNotiyFormRef",ref:g,model:(0,c.SU)(C),rules:_,"label-width":"120px",onConfirm:a[4]||(a[4]=(0,d.iM)((()=>{}),["prevent"]))},{default:(0,u.w5)((()=>[(0,u.Wm)(f,{label:"通知组名称",prop:"name"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:(0,c.SU)(C).name,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,c.SU)(C).name=e),modelModifiers:{trim:!0},placeholder:"请输入通知组名称"},null,8,["modelValue"])])),_:1}),(0,u.Wm)(f,{label:"告警设备维度",prop:"choose_type"},{default:(0,u.w5)((()=>[(0,u.Wm)(k,{modelValue:(0,c.SU)(C).choose_type,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,c.SU)(C).choose_type=e),onChange:I},{default:(0,u.w5)((()=>[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(b,(e=>(0,u.Wm)(v,{key:e.key,label:e.key},{default:(0,u.w5)((()=>[(0,u.Uk)((0,r.zw)(e.name),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,u.Wm)(f,{label:"选择设备",prop:"count"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{disabled:"",placeholder:"已选择"+((0,c.SU)(C).filter?.count||0)+"台"+(0,c.SU)(W).showText},null,8,["placeholder"]),(0,u.Wm)(S,{class:"form-btn",type:"primary",onClick:x},{default:(0,u.w5)((()=>[(0,u.Uk)(" 选择"+(0,r.zw)((0,c.SU)(W).showText),1)])),_:1})])),_:1}),(0,u.Wm)(f,{label:"通知用户",prop:"usercount"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{disabled:"",placeholder:"已选择"+((0,c.SU)(C).update_operations?.usercount||0)+"个用户"},null,8,["placeholder"]),(0,u.Wm)(S,{class:"form-btn",type:"primary",onClick:H},{default:(0,u.w5)((()=>[(0,u.Uk)(" 通知用户 ")])),_:1})])),_:1}),(0,u.Wm)(f,{label:"通知方式",prop:"notification",class:"notification-form"},{default:(0,u.w5)((()=>[(0,u.Wm)(E,{modelValue:(0,c.SU)(W).checkAll,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,c.SU)(W).checkAll=e),indeterminate:(0,c.SU)(W).isIndeterminate,onChange:T},{default:(0,u.w5)((()=>[(0,u.Uk)(" 所有 ")])),_:1},8,["modelValue","indeterminate"]),(0,u.Wm)(M,{modelValue:(0,c.SU)(C).notification,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,c.SU)(C).notification=e),onChange:B},{default:(0,u.w5)((()=>[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(U,(e=>(0,u.Wm)(E,{key:e.key,label:e.key},{default:(0,u.w5)((()=>[(0,u.Uk)((0,r.zw)(e.name),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,c.SU)(W).selectDeviceData.visible?((0,u.wg)(),(0,u.j4)((0,c.SU)(y),{key:0,"select-device-data":(0,c.SU)(W).selectDeviceData.data,visible:(0,c.SU)(W).selectDeviceData.visible,onCancel:q,onConfirm:j},null,8,["select-device-data","visible"])):(0,u.kq)("",!0),(0,c.SU)(W).selectRoomData.visible?((0,u.wg)(),(0,u.j4)((0,c.SU)(p),{key:1,"checked-data":(0,c.SU)(W).selectRoomData.userids,visible:(0,c.SU)(W).selectRoomData.visible,type:(0,c.SU)(C).choose_type,onCancel:A,onConfirm:z},null,8,["checked-data","visible","type"])):(0,u.kq)("",!0),(0,c.SU)(W).notifyUserData.visible?((0,u.wg)(),(0,u.j4)((0,c.SU)(h),{key:2,"notify-user-data":(0,c.SU)(W).notifyUserData.data,visible:(0,c.SU)(W).notifyUserData.visible,onCancel:K,onConfirm:N},null,8,["notify-user-data","visible"])):(0,u.kq)("",!0)])),_:1},8,["modelValue","title"])}}};function p(e){e.__source="src/views/problem/component/AlarmNotifyInfo/index.vue"}var y=t(83744);"function"===typeof p&&p(v);const h=(0,y.Z)(v,[["__scopeId","data-v-51cc769a"]]);var b=h}}]);